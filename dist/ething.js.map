{"version":3,"sources":["webpack://EThing/webpack/universalModuleDefinition","webpack://EThing/webpack/bootstrap","webpack://EThing/./src/utils.js","webpack://EThing/./src/core.js","webpack://EThing/./src/resource.js","webpack://EThing/./src/deferred.js","webpack://EThing/./src/device.js","webpack://EThing/./src/deferredObject.js","webpack://EThing/./src/eventEngine.js","webpack://EThing/./src/event.js","webpack://EThing/./src/arbo.js","webpack://EThing/./src/devices/mqtt.js","webpack://EThing/./src/devices/http.js","webpack://EThing/./src/rule.js","webpack://EThing/./src/app.js","webpack://EThing/./src/table.js","webpack://EThing/./src/file.js","webpack://EThing/./src/notify.js","webpack://EThing/./src/settings.js","webpack://EThing/./src/error.js","webpack://EThing/./src/extra-browser.js","webpack://EThing/./src/ething.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Utils","buildParams","prefix","obj","add","Array","isArray","v","test","isId","length","parseUrl","url","exec","scheme","user","password","hostname","port","path","search","hash","getParam","key","queryIndex","indexOf","regex","RegExp","encodeURIComponent","results","substr","decodeURIComponent","getQueryString","removeParam","urlparts","split","hashIndex","pars","lastIndexOf","splice","join","insertParam","query","param","data","replace","pad","width","z","sizeToString","parseInt","isNaN","Math","floor","dateToString","now","Date","getTime","getHours","getMinutes","curr_year","getFullYear","curr_date","getDate","curr_month","getMonth","dateDiffToString","diffInSec","divideBy","w","cache","createCache","requestFunction","callback","state","done","class2type","toString","hasOwn","forEach","toLowerCase","type","isPlainObject","nodeType","constructor","e","undefined","extend","options","src","copy","copyIsArray","clone","target","arguments","deep","this","isEqual","x","y","Function","valueOf","keys","every","inherits","extended","parent","toBase64","content","Blob","FileReader","reader","Deferred","onloadend","result","readAsDataURL","ArrayBuffer","binary","bytes","Uint8Array","byteLength","String","fromCharCode","btoa","Buffer","utils","Error","Event","EventEngine","DeferredObject","EThing","XMLHttpRequest","config","serverUrl","ajaxSuccessHandlers","ajaxCompleteHandlers","ajaxErrorHandlers","ajaxSendHandlers","apiRequestPrefilterHandler","toApiUrl","auth","apiUrl","isApiUrl","_processAuth","ajax","deferred","xhr","method","context","contentType","headers","dataType","converter","synchronous","apiRequest","toUpperCase","isBodyRequest","body","hasData","open","requestContentType","setRequestHeader","JSON","stringify","reject","error","ct","getResponseHeader","responseType","response","FileReaderSync","fileReader","apply","readAsArrayBuffer","onload","resolve","when","always","parse","args","status","statusText","trigger","handler","rejectWith","err","resolveWith","onerror","onabort","onprogress","notifyWith","evt","isDefaultPrevented","send","promise","instanciate","json","extends","clsName","resourceConverter","map","filter","arbo","update","resources","request","opt","slice","apiRequestPrefilter","ajaxSend","push","ajaxComplete","ajaxSuccess","ajaxError","list","find","a","b","q","Resource","id","usage","NoAuth","_resource","_scope","_authType","isAuthenticated","getApp","App","getDevice","Device","getResource","getScope","reset","setApiKey","apiKey","xhrOrUrl","setBasicAuth","login","initialize","successFn","errorFn","resource","scope","authenticatedCb_","cb","fail","authenticated","_fromJson","noTrigger","updated","_json","modifiedDate","updatedKeys","createdBy","createdDate","description","isTypeof","dirname","basename","extension","types","baseType","t","ctime","mtime","public","defaultValue","attr","hasAttr","remove","removeChildren","set","properties","unshift","setData","children","X-HTTP-Method-Override","f","pop","fnmatch","pattern","parsedPattern","regexp","patternTab","match","D","fn","doneFuncs","failFuncs","progressFuncs","resultArgs","tuples","arr","j","progress","then","fns","newDefer","tuple","returned","notify","debug","console","log","isRejected","isResolved","df","size","rp","methods","operationId","self","execute","getApi","executeUrl","location","connected","lastSeenDate","hasBattery","battery","interfaces","device","isNode","create","resolvedDfr","queue","processQueue","dfr","pending","fctname","action","event_map","on","events","event","off","one","extraParameters","h","concat","isImmediatePropagationStopped","isPropagationStopped","returnTrue","returnFalse","props","timeStamp","preventDefault","stopPropagation","stopImmediatePropagation","loaddfr","Folder","isRoot","newResources","replaceAll","removed","added","index","found","hasChanged","noTraversingUp","findOneById","folder","deferreds","filter_","fd","relativeName","ls","findOne","res","resourceId","load","force","pdfr","rs","lastRefreshTs","refresh","isLoaded","MQTT","getSubscription","dev","subs","subscription","Http","getSpecification","spec","swaggerSpecification","Rule","enabled","script","scriptReturnCode","script_return_code","scriptExecutionCount","script_execution_count","scriptExecutionDate","script_execution_date","file_id","iconLink","hasIcon","getContentUrl","contentModifiedDate","version","read","write","icon","getIcon","Table","maxLength","expireAfter","k","select","computeStatistics","removeRow","replaceRow","findOneAndReplace","upsert","insert","import","table_id","fields","start","sort","datefmt","docId","postData","invalid_field","table","skip_error","File","mime","thumbnailLink","hasThumbnail","isText","isScript","file","subject","message","settings","__proto__","captureStackTrace","atob"],"mappings":"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","file":"ething.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EThing\"] = factory();\n\telse\n\t\troot[\"EThing\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","\nvar extra = require(\"./extra.js\");\n\nvar Utils = extra || {};\n\n\nUtils.isId = function(s){\n\treturn (typeof s == 'string' && s.length === 7 && /^[0-9a-zA-Z\\-_]+$/.test(s));\n}\n\n\nUtils.parseUrl = function(url){\n\tvar r = /^((([a-z]+):)?\\/\\/)?(([^:]*)(:([^@]*))?@)?([^:\\/?#]+)?(:([0-9]+))?([^?#]+)?(\\?[^#]*)?(#.*)?$/i.exec(url);\n\treturn r ? {\n\t\tscheme : r[3],\n\t\tuser : r[5],\n\t\tpassword : r[7],\n\t\thostname : r[8],\n\t\tport : r[10],\n\t\tpath : r[11],\n\t\tsearch : r[12],\n\t\thash: r[13]\n\t} : false;\n}\n\nUtils.getParam = function(url, key) {\n\tvar queryIndex = url.indexOf('?'); \n\tvar regex = new RegExp(\"[\\\\?&]\" + encodeURIComponent(key) + \"=([^&#]*)\"),\n\t\tresults = queryIndex!==-1 ? regex.exec(url.substr(queryIndex)) : null;\n\treturn results === null ? \"\" : decodeURIComponent(results[1]);\n}\n\nUtils.getQueryString = function(url, key) {\n\tvar queryIndex = url.indexOf('?'); \n\tvar regex = new RegExp(\"[\\\\?&]\" + encodeURIComponent(key) + \"=([^&#]*)\"),\n\t\tresults = queryIndex!==-1 ? regex.exec(url.substr(queryIndex)) : null;\n\treturn results === null ? \"\" : decodeURIComponent(results[1]);\n}\n\nUtils.removeParam = function(url,key){\n\t//prefer to use l.search if you have a location/link object\n\tvar urlparts= url.split('?');   \n\tif (urlparts.length>=2) {\n\t\t\n\t\tvar hashIndex = urlparts[1].indexOf('#'),\n\t\t\thash = '';\n\t\tif(hashIndex !== -1){\n\t\t\thash = urlparts[1].substr(hashIndex);\n\t\t\turlparts[1] = urlparts[1].substr(0,hashIndex);\n\t\t}\n\t\t\t\n\t\tvar prefix= encodeURIComponent(key)+'=';\n\t\tvar pars= urlparts[1].split(/[&;]/g);\n\n\t\t//reverse iteration as may be destructive\n\t\tfor (var i= pars.length; i-- > 0;) {    \n\t\t\t//idiom for string.startsWith\n\t\t\tif (pars[i].lastIndexOf(prefix, 0) !== -1) {  \n\t\t\t\tpars.splice(i, 1);\n\t\t\t}\n\t\t}\n\n\t\turl= urlparts[0] + (pars.length > 0 ? '?' + pars.join('&') : \"\") + hash;\n\t\treturn url;\n\t} else {\n\t\treturn url;\n\t}\n};\n\nUtils.insertParam = function(url,key,value){\n\t\n\turl = Utils.removeParam(url,key);\n\t\n\tvar hashIndex = url.indexOf('#'),\n\t\thash = '';\n\tif(hashIndex !== -1){ // extract hash\n\t\thash = url.substr(hashIndex);\n\t\turl = url.substr(0,hashIndex);\n\t}\n\t\n\tvar queryIndex = url.indexOf('?'),\n\t\tquery = '';\n\tif(queryIndex !== -1){ // extract query\n\t\tquery = url.substr(queryIndex);\n\t\turl = url.substr(0,queryIndex);\n\t}\n\t\n\tquery += query.length ? '&' : '?';\n\tquery += encodeURIComponent(key)+'='+encodeURIComponent(value);\n\t\n\treturn url+query+hash;\n};\n\n\nfunction buildParams( prefix, obj, add ) {\n\tvar name;\n\n\tif ( Array.isArray( obj ) ) {\n\t\t// Serialize array item.\n\t\tfor(var i in obj){\n\t\t\tvar v = obj[i];\n\t\t\tif ( /\\[\\]$/.test( prefix ) ) {\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, v );\n\n\t\t\t} else {\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n\t\t\t\tbuildParams( prefix + \"[\" + ( typeof v === \"object\" ? i : \"\" ) + \"]\", v, add );\n\t\t\t}\n\t\t};\n\n\t} else if ( typeof obj === \"object\" ) {\n\t\t// Serialize object item.\n\t\tfor ( name in obj ) {\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], add );\n\t\t}\n\n\t} else {\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\nUtils.param = function(data){\n\t\n\tvar prefix,\n\t\ts = [],\n\t\tadd = function( key, value ) {\n\t\t\t// If value is a function, invoke it and return its value\n\t\t\tvalue = (typeof value == 'function') ? value() : ( value == null ? \"\" : value );\n\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" + encodeURIComponent( value );\n\t\t};\n\n\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t// did it), otherwise encode params recursively.\n\tfor ( prefix in data ) {\n\t\tif(!(data[prefix] === null || typeof data[prefix] == 'undefined'))\n\t\t\tbuildParams( prefix, data[ prefix ], add );\n\t}\n\n\t// Return the resulting serialization\n\treturn s.join( \"&\" ).replace( /%20/g, \"+\" );\n\t\n}\n\n\n\n\nvar pad = Utils.pad = function(n, width, z) {\n\tz = z || '0';\n\tn = n + '';\n\treturn n.length >= width ? n : new Array(width - n.length + 1)\n\t\t.join(z) + n;\n}\n\n\nUtils.sizeToString = function(s) {\n\ts = parseInt(s);\n\tif(isNaN(s)) return '-';\n\tvar coef = 0.9;\n\tif (s > 1000000000 * coef)\n\t\ts = (Math.floor((s / 1000000000) * 100 ) / 100) + ' GB';\n\telse if (s > 1000000 * coef)\n\t\ts = (Math.floor((s / 1000000) * 100) / 100) + ' MB';\n\telse if (s > 1000 * coef)\n\t\ts = (Math.floor((s / 1000) * 100) / 100) + ' KB';\n\telse\n\t\ts = s + ' B';\n\treturn s;\n};\n\nUtils.dateToString = function(d) {\n\tvar now = new Date();\n\t\n\tif(typeof d == 'number'){\n\t\td = new Date(d*1000);\n\t}\n\t\n\tif(!d)\n\t\treturn '-';\n\telse if(now.getTime()-d.getTime() < 86400000){\n\t\t// 22:52\n\t\treturn pad(d.getHours(),2) + ':' + pad(d.getMinutes(),2);\n\t}\n\telse {\n\t\tvar curr_year = d.getFullYear();\n\t\tvar curr_date = d.getDate();\n\t\tvar curr_month = d.getMonth();\n\t\t\n\t\tif(curr_year == now.getFullYear()){\n\t\t\t// Jul. 27\n\t\t\tvar m_names = new Array(\"Jan\", \"Feb\", \"Mar\",\n\t\t\t\t\"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\",\n\t\t\t\t\"Oct\", \"Nov\", \"Dec\");\n\t\t\treturn curr_date + ' ' + m_names[curr_month] + '.';\n\t\t}\n\t\telse {\n\t\t\t// 2014/07/27\n\t\t\treturn curr_year + '/' + pad(curr_month+1,2) + '/' + pad(curr_date,2);\n\t\t}\n\t}\n};\n\nUtils.dateDiffToString = function(diffInSec) {\n\tdiffInSec = parseInt(diffInSec);\n\tif(isNaN(diffInSec)) return '-';\n\t// transform it into interval\n\tvar divideBy = {\n\t\t\tw: 604800,\n\t\t\td: 86400,\n\t\t\th: 3600,\n\t\t\tm: 60\n\t\t},\n\t\tw = 0, // number of word\n\t\ts = '', // output string\n\t\tv;\n\tv = Math.floor(diffInSec / divideBy.w);\n\tif (v >= 1 && w < 2) {\n\t\ts += Math.floor(v) + ' week' + (v > 1 ? 's' : '');\n\t\tdiffInSec -= v * divideBy.w;\n\t\tw++;\n\t}\n\tv = Math.floor(diffInSec / divideBy.d);\n\tif (v >= 1 && w < 2) {\n\t\tif (w) s += ' ';\n\t\ts += Math.floor(v) + ' day' + (v > 1 ? 's' : '');\n\t\tdiffInSec -= v * divideBy.d;\n\t\tw++;\n\t}\n\tv = Math.floor(diffInSec / divideBy.h);\n\tif (v >= 1 && w < 2) {\n\t\tif (w) s += ' ';\n\t\ts += Math.floor(v) + ' hour' + (v > 1 ? 's' : '');\n\t\tdiffInSec -= v * divideBy.h;\n\t\tw++;\n\t}\n\tv = Math.floor(diffInSec / divideBy.m);\n\tif (v >= 1 && w < 2) {\n\t\tif (w) s += ' ';\n\t\ts += Math.floor(v) + ' minute' + (v > 1 ? 's' : '');\n\t\tdiffInSec -= v * divideBy.m;\n\t\tw++;\n\t}\n\tv = diffInSec;\n\tif (v >= 1 && w < 2) {\n\t\tif (w) s += ' ';\n\t\ts += Math.floor(v) + ' seconde' + (v > 1 ? 's' : '');\n\t\tw++;\n\t}\n\n\treturn s;\n};\n\n\nvar cache = {};// private\n\nUtils.createCache = function( requestFunction ) {\n\treturn function( key, callback ) {\n\t\tif ( !cache[key] || (typeof cache[key].state == 'function' && cache[key].state() === 'rejected') ) {\n\t\t\tcache[key] = requestFunction(key);\n\t\t}\n\t\treturn cache[key].done( callback );\n\t};\n};\n\n\n\n\n\n\n\n\nvar class2type = {},\n\ttoString = class2type.toString,\n\thasOwn = class2type.hasOwnProperty;\n\n// Populate the class2type map\n\"Boolean Number String Function Array Date RegExp Object Error Symbol\".split(\" \").forEach(function(name){\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n});\n\n\nUtils.type = function( obj ) {\n\tif ( obj == null ) {\n\t\treturn obj + \"\";\n\t}\n\n\t// Support: Android<4.0, iOS<6 (functionish RegExp)\n\treturn typeof obj === \"object\" || typeof obj === \"function\" ?\n\t\tclass2type[ toString.call( obj ) ] || \"object\" :\n\t\ttypeof obj;\n};\n\nUtils.isPlainObject = function( obj ) {\n\tvar key;\n\n\t// Not plain objects:\n\t// - Any object or value whose internal [[Class]] property is not \"[object Object]\"\n\t// - DOM nodes\n\t// - window\n\tif ( Utils.type( obj ) !== \"object\" || obj.nodeType || (obj != null && obj === obj.window) ) {\n\t\treturn false;\n\t}\n\t\n\ttry {\n\t\t// Not own constructor property must be Object\n\t\tif ( obj.constructor &&\n\t\t\t\t!hasOwn.call( obj, \"constructor\" ) &&\n\t\t\t\t!hasOwn.call( obj.constructor.prototype || {}, \"isPrototypeOf\" ) ) {\n\t\t\treturn false;\n\t\t}\n\t} catch ( e ) {\n\t  // IE8,9 Will throw exceptions on certain host objects #9897\n\t  return false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own\n\tfor ( key in obj ) {}\n\n\treturn key === undefined || hasOwn.call( obj, key );\n};\n\nUtils.extend = function() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t  target = arguments[0] || {},\n\t  i = 1,\n\t  length = arguments.length,\n\t  deep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t  deep = target;\n\t  target = arguments[1] || {};\n\t  // skip the boolean and the target\n\t  i = 2;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && typeof target !== 'function' ) {\n\t  target = {};\n\t}\n\n\tif ( length === i ) {\n\t  target = this;\n\t  --i;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\t  // Only deal with non-null/undefined values\n\t  if ( (options = arguments[ i ]) != null ) {\n\t\t// Extend the base object\n\t\tfor ( name in options ) {\n\t\t  src = target[ name ];\n\t\t  copy = options[ name ];\n\n\t\t  // Prevent never-ending loop\n\t\t  if ( target === copy ) {\n\t\t\tcontinue;\n\t\t  }\n\n\t\t  // Recurse if we're merging plain objects or arrays\n\t\t  if ( deep && copy && ( Utils.isPlainObject(copy) || (copyIsArray = Array.isArray(copy)) ) ) {\n\t\t\tif ( copyIsArray ) {\n\t\t\t  copyIsArray = false;\n\t\t\t  clone = src && Array.isArray(src) ? src : [];\n\n\t\t\t} else {\n\t\t\t  clone = src && Utils.isPlainObject(src) ? src : {};\n\t\t\t}\n\n\t\t\t// Never move original objects, clone them\n\t\t\ttarget[ name ] = Utils.extend( deep, clone, copy );\n\n\t\t  // Don't bring in undefined values\n\t\t  } else if ( copy !== undefined ) {\n\t\t\ttarget[ name ] = copy;\n\t\t  }\n\t\t}\n\t  }\n\t}\n\t// Return the modified object\n\treturn target;\n};\n\nUtils.isEqual = function(x, y) {\n\t'use strict';\n\n\tif (x === null || x === undefined || y === null || y === undefined) { return x === y; }\n\t// after this just checking type of one would be enough\n\tif (x.constructor !== y.constructor) { return false; }\n\t// if they are functions, they should exactly refer to same one (because of closures)\n\tif (x instanceof Function) { return x === y; }\n\t// if they are regexps, they should exactly refer to same one (it is hard to better equality check on current ES)\n\tif (x instanceof RegExp) { return x === y; }\n\tif (x === y || x.valueOf() === y.valueOf()) { return true; }\n\tif (Array.isArray(x) && x.length !== y.length) { return false; }\n\n\t// if they are dates, they must had equal valueOf\n\tif (x instanceof Date) { return false; }\n\n\t// if they are strictly equal, they both need to be object at least\n\tif (!(x instanceof Object)) { return false; }\n\tif (!(y instanceof Object)) { return false; }\n\n\t// recursive object equality check\n\tvar p = Object.keys(x);\n\treturn Object.keys(y).every(function (i) { return p.indexOf(i) !== -1; }) &&\n\t\tp.every(function (i) { return Utils.isEqual(x[i], y[i]); });\n}\n\n\nUtils.inherits = function (extended, parent){\n\textended.prototype = new parent();\n\textended.prototype.constructor = extended; // fix constructor property\n};\n\n\nUtils.toBase64 = function(content, callback){\n    \n    if(content instanceof Utils.Blob){\n        // asynchronous\n        \n        if(!Utils.FileReader)\n            throw 'no FileReader instance found';\n        \n        var reader = new Utils.FileReader(), dfr = Deferred();\n        reader.onloadend = function() {\n          content = reader.result.substr(reader.result.indexOf(';base64,')+8);\n          callback(content);\n        }\n        reader.readAsDataURL(content);\n        \n        return;\n    }\n    else if(content instanceof ArrayBuffer){\n        var binary = '',\n            bytes = new Uint8Array(content);\n        for (var i = 0; i < bytes.byteLength; i++) {\n            binary += String.fromCharCode( bytes[ i ] );\n        }\n        content = Utils.btoa(binary);\n    }\n    else if(content instanceof Utils.Buffer){\n        content = content.toString('base64');\n    }\n    else if(typeof content === 'string'){\n        content = Utils.btoa(content);\n    } else {\n        throw 'invalid type';\n    }\n    \n    callback(content);\n    \n    return;\n}\n\n\t\n\nmodule.exports = Utils;\n\n","\nvar utils = require(\"./utils.js\");\nvar Deferred = require(\"./deferred.js\");\nvar Error = require(\"./error.js\");\nvar Event = require(\"./event.js\");\nvar EventEngine = require(\"./eventEngine.js\");\nvar DeferredObject = require(\"./deferredObject.js\");\n\n\n/**\n * Contains all eThing API classes and functions.\n * @namespace EThing\n */\nvar EThing = {};\n\n\nvar extend = utils.extend;\nvar isPlainObject = utils.isPlainObject;\n\nvar XMLHttpRequest = utils.XMLHttpRequest;\n\n\nEThing.Event = Event;\nEThing.Error = Error;\n\nEThing.utils = utils;\nEThing.utils.Deferred = Deferred;\n\nEThing.DeferredObject = DeferredObject;\n\nEThing.config = {\n\tserverUrl: 'http://localhost:8000'\n};\n\n\nvar ajaxSuccessHandlers = [],\n\tajaxCompleteHandlers = [],\n\tajaxErrorHandlers = [],\n\tajaxSendHandlers = [],\n\tapiRequestPrefilterHandler = null;\n\n\n\n\n\n/**\n * register an handler to an event.\n * @name on\n * @memberof EThing\n * @param {string} event event type string. Multiple space separated events can be given.\n * @param {function(EThing.Event)} handler the function to be called when the event has been triggered.\n */\n\n/**\n * Remove an event handler.\n * @name off\n * @memberof EThing\n * @param {string} event event type string. Multiple space separated events can be given.\n * @param {function(EThing.Event)} [handler] A handler function previously attached for the event(s)\n */\n\n/**\n * register an handler to an event. The handler will be only executed once.\n * @name one\n * @memberof EThing\n * @param {string} event event type string. Multiple space separated events can be given.\n * @param {function(EThing.Event)} handler the function to be called when the event has been triggered.\n */\n\n/**\n * Execute all handlers attached for the given event type.\n * @name trigger\n * @memberof EThing\n * @param {string|EThing.Event} event An event object instance or an event type string.\n * @param {object} [extraParameters] Additional parameters to pass along to the event handler.\n */\n\n\n/**\n * @memberof EThing\n * @event \"ething.resource.removed\"\n */\n \n/**\n * @memberof EThing\n * @event \"ething.file.created\"\n */\n \n/**\n * @memberof EThing\n * @event \"ething.table.created\"\n */\n \n/**\n * @memberof EThing\n * @event \"ething.device.created\"\n */\n \n/**\n * @memberof EThing\n * @event \"ething.app.created\"\n */\n/**\n * authenticated event.\n *\n * @memberof EThing\n * @event \"ething.authenticated\"\n */\nEventEngine(EThing);\n\n\n\n// only absolute url will be preserved untouched,\n// else api server url is prepended\nEThing.toApiUrl = function(url, auth){\n\turl = url || '';\n\t\n\tif(!/^([a-z]+:)?\\/\\//.test(url)){\n\t\t// relative url\n\t\tif(!/^\\//.test(url) && url)\n\t\t\turl = '/'+url;\n\t\t\n\t\turl = apiUrl() + url;\n\t}\n\t\n\tif(auth && isApiUrl(url)){\n\t\turl = _processAuth(url);\n\t\tif(typeof apiRequestPrefilterHandler == 'function')\n\t\t\turl = apiRequestPrefilterHandler(url);\n\t}\n\treturn url;\n}\n\n// returns true if it is an URL to the HTTP API\nvar isApiUrl = function(url){\n\treturn (new RegExp('^([a-z]+:)?//'+apiUrl().replace(/^([a-z]+:)?\\/\\//,''))).test(url);\n}\n\n\nvar apiUrl = function(){\n\treturn EThing.config.serverUrl.replace(/\\/+$/, '') + '/api';\n}\n\nEThing.apiUrl = function(){\n\treturn EThing.toApiUrl();\n}\n\n\n\nvar ajax = function(options){\n\tvar deferred = new Deferred(),\n\t\txhr = new XMLHttpRequest();\n\t\n\tif(typeof options == 'string')\n\t\toptions = {\n\t\t\turl: options\n\t\t};\n\t\n\toptions = extend({\n\t\tmethod: 'GET',\n\t\tcontext: null,\n\t\turl: null,\n\t\tdata: null,\n\t\tcontentType: null, // When sending data to the server, use this content type , default to 'application/x-www-form-urlencoded; charset=UTF-8'\n\t\theaders: null,\n\t\tdataType: null, // The type of data that you're expecting back from the server (json -> {object}, text -> {string} , arraybuffer, blob -> (not available on nodejs), buffer (nodejs only) )\n\t\tconverter: null, // a user defined function to convert the receive data into something else ...\n\t\tsynchronous: false\n\t},options);\n\t\n\t\n\tif(typeof options.url != 'string')\n\t\treturn null;\n\t\n\tvar url = EThing.toApiUrl(options.url);\n\tvar apiRequest = isApiUrl(url);\n\t\n\t\n\toptions.method = options.method.toUpperCase();\n\t\n\tvar context = options.context || EThing;\n\t\n\tvar isBodyRequest = !/^(?:GET|HEAD)$/.test( options.method ),\n\t\tbody = undefined,\n\t\thasData = typeof options.data != 'undefined' && options.data !== null;\n\t\n\t\n\t\n\t// If data is available, append data to url\n\tif ( !isBodyRequest && hasData ){\n\t\t// GET, HEAD request, append the data to the query string\n\t\turl += ( /\\?/.test( url ) ? \"&\" : \"?\" ) + ( typeof options.data == 'string' ? options.data : utils.param(options.data));\n\t}\n\t\n\t\n\txhr.open(options.method, url, !options.synchronous);\n\t\n\t\n\t// user headers\n\tvar requestContentType = null;\n\tif(isPlainObject(options.headers)){\n\t\tfor(var i in options.headers){\n\t\t\tif(options.headers.hasOwnProperty(i)){\n\t\t\t\tif(/^content-type$/i.test(i)){\n\t\t\t\t\trequestContentType = options.headers[i];\n\t\t\t\t}\n\t\t\t\txhr.setRequestHeader(i, options.headers[i]);\t\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// content-type header\n\tif(!requestContentType && options.contentType)\n\t\txhr.setRequestHeader('Content-Type', requestContentType = options.contentType);\n\t\n\tif(isBodyRequest && hasData){\n\t\t\n\t\tif(requestContentType){\n\t\t\t\n\t\t\tbody = options.data;\n\t\t\t\n\t\t\tif(isPlainObject(options.data) || Array.isArray(options.data)){\n\t\t\t\t// transform the data according to the content-type\n\t\t\t\tif(/json/i.test(requestContentType))\n\t\t\t\t\tbody = JSON.stringify(options.data)\n\t\t\t\telse if(/application\\/x-www-form-urlencoded/i.test(requestContentType))\n\t\t\t\t\tbody = utils.param(options.data);\n\t\t\t}\n\t\t\t\n\t\t} else {\n\t\t\t// no content-type set, set to defaults\n\t\t\tif(options.data instanceof Blob){\n\t\t\t\txhr.setRequestHeader('Content-Type', requestContentType = options.data.type);\n\t\t\t\tbody = options.data;\n\t\t\t} else if( (options.data instanceof ArrayBuffer) || (options.data instanceof utils.Buffer) ){\n\t\t\t\txhr.setRequestHeader('Content-Type', requestContentType = 'application/octet-stream');\n\t\t\t\tbody = options.data;\n\t\t\t} else {\n\t\t\t\txhr.setRequestHeader('Content-Type', requestContentType = 'application/x-www-form-urlencoded; charset=UTF-8');\n\t\t\t\tbody = typeof options.data == 'string' ? options.data : utils.param(options.data);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t\n\t// authentication\n\tif(apiRequest){\n\t\txhr = _processAuth(xhr);\n\t\tif(typeof apiRequestPrefilterHandler == 'function')\n\t\t\txhr = apiRequestPrefilterHandler(xhr);\n\t}\n\t\n\t// responseType\n\tvar dataType = options.dataType;\n\tif(dataType && dataType != 'auto') xhr.responseType = dataType;\n\t\n\tfunction reject(error){\n\t\t\n\t\tvar ct = xhr.getResponseHeader(\"Content-Type\") || '',\n\t\t\tdata = null;\n\t\t\n\t\tif(typeof error != 'undefined'){\n\t\t\tdata = error;\n\t\t}\n\t\telse if(/json/.test(ct) || /text\\/plain/.test(ct)){\n\t\t\t\n\t\t\t\n\t\t\tswitch(xhr.responseType){\n\t\t\t\t\n\t\t\t\tcase '':\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'json':\n\t\t\t\t\tdata = xhr.response;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'blob':\n\t\t\t\t\t\n\t\t\t\t\tif(options.synchronous){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!utils.FileReaderSync){\n\t\t\t\t\t\t\tthrow new Error(\"FileReaderSync not supported.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar fileReader = new utils.FileReaderSync();\n\t\t\t\t\t\tdata = String.fromCharCode.apply(null, new Uint8Array(fileReader.readAsArrayBuffer(xhr.response)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata = Deferred();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!utils.FileReader){\n\t\t\t\t\t\t\tthrow new Error(\"FileReaderSync not supported.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar fileReader = new utils.FileReader();\n\t\t\t\t\t\tfileReader.onload = function() {\n\t\t\t\t\t\t\tdata.resolve( String.fromCharCode.apply(null, new Uint8Array(this.result)) );\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfileReader.readAsArrayBuffer(xhr.response);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'arraybuffer':\n\t\t\t\t\tdata = String.fromCharCode.apply(null, new Uint8Array(xhr.response));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdata = xhr.response.toString(\"utf8\");\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(xhr.responseType+\" response type not supported.\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tDeferred.when(data).always(function(data){\n\t\t\t\n\t\t\ttry{\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t} catch(e){}\n\t\t\t\n\t\t\tvar error = new Error(data || (xhr.status ? (xhr.status+' ['+xhr.statusText+']') : 'unknown error')),\n\t\t\t\targs = [error,xhr,options];\n\t\t\t\n\t\t\tEThing.trigger('ething.request.error',args);\n\t\t\tajaxErrorHandlers.forEach(function(handler){\n\t\t\t\thandler.apply(context,args);\n\t\t\t});\n\t\t\tEThing.trigger('ething.request.complete',args);\n\t\t\tajaxCompleteHandlers.forEach(function(handler){\n\t\t\t\thandler.apply(context,args);\n\t\t\t});\n\t\t\tdeferred.rejectWith(context,args);\n\t\t\t\n\t\t});\n\t\t\n\t\t\n\t}\n\t\n\tfunction resolve(data){\n\t\tvar args = [data,xhr,options];\n\t\t\n\t\tEThing.trigger('ething.request.success',args);\n\t\tajaxSuccessHandlers.forEach(function(handler){\n\t\t\thandler.apply(context,args);\n\t\t});\n\t\tEThing.trigger('ething.request.complete',args);\n\t\tajaxCompleteHandlers.forEach(function(handler){\n\t\t\thandler.apply(context,args);\n\t\t});\n\t\tdeferred.resolveWith(context,args);\n\t}\n\t\n\t// events\n\txhr.onload=function(){\n\t\tvar success = xhr.status >= 200 && xhr.status < 300 || xhr.status === 304;\n\t\tif (success) {  \n\t\t\t// success\n\t\t\tvar data = xhr.response;\n\t\t\t\n\t\t\tif(dataType == 'auto'){\n\t\t\t\tif(/json/.test(xhr.getResponseHeader(\"Content-Type\") || '')){\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t} catch(err){}\n\t\t\t\t}\n\t\t\t} else if(dataType == 'json' && typeof data === 'string'){ // for ie compatibility\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t} catch(err){}\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof options.converter == 'function'){\n\t\t\t\tdata = options.converter.call(context,data,xhr,options);\n\t\t\t}\n\t\t\t\n\t\t\tresolve(data);\n\t\t}\n\t\telse\n\t\t\treject();\n\t}\n\txhr.onerror=function(err){reject(err);};\n\txhr.onabort=function(){reject();};\n\txhr.onprogress=function(e){\n\t\tdeferred.notifyWith(context,[e,xhr,options]);\n\t}\n\t\n\tvar evt = Event('ething.request.send');\n\tEThing.trigger(evt,[xhr, options]);\n\t\n\tif(evt.isDefaultPrevented()){\n\t\treject('Aborded');\n\t}\n\telse {\n\t\n\t\tajaxSendHandlers.forEach(function(handler){\n\t\t\thandler.call(context,xhr);\n\t\t});\n\t\t\n\t\txhr.send(body);\n\t\t\n\t}\n\t\n\treturn deferred.promise();\n}\n\n\n\n\nvar instanciate = EThing.instanciate = function (json){\n    \n    for(var i in json.extends){\n        var clsName = json.extends[i];\n        \n        if(typeof EThing[clsName] != 'undefined'){\n            return new EThing[clsName](json)\n        }\n        \n    }\n    \n\treturn false;\n}\n\n\n\n\n\n// if the argument is a json object describing a resource, then it converts it into a Resource instance, else it returns the object unchanged\nEThing.resourceConverter = function(data){\n\t\n\tif(typeof data == 'object' && data !== null){\n\t\t\n\t\tvar isArray = Array.isArray(data);\n\t\tif(!isArray) data = [data];\n\t\t\n\t\t// convert into resource instance\n\t\tdata = data.map(function(r){\n\t\t\treturn EThing.instanciate(r);\n\t\t}).filter(function(r){\n\t\t\treturn r;\n\t\t});\n\t\t\n\t\t\n\t\t// update the arbo collection with the new properties\n\t\t// and return the corresponding resource object(s)\n\t\tif(EThing.arbo)\n\t\t\tdata = EThing.arbo.update(data).resources;\n\t\t\n\t\tif(!isArray) data = data.length ? data[0] : null;\n\t}\n\t\n\treturn data;\n}\n\n\n\n\n/**\n * Make a HTTP request. The options object contains the following properties :\n *  - url {string} __required__ The url of the request. The API url will be prepended to relative URLs.\n *  - method {string} The HTTP request method to use. Default is GET.\n *  - data {string|object|Blob|ArrayBuffer|Buffer} The query string for GET request. The HTTP request body for POST|PATCH|PUT requests. If an object is given, it will be serialized into a query string.\n *  - contentType {string} When sending data to the server, use this content type. Default is 'application/octet-stream' if the data is an instance of ArrayBuffer or Buffer, if data is an instance of Blob, the default will be the type of the data itself, else 'application/x-www-form-urlencoded; charset=UTF-8'.\n *  - dataType {string} The type of data that you're expecting back from the server. See {@link http://xhr.spec.whatwg.org/#the-responsetype-attribute|XMLHttpRequest standard}.\n *  - headers {object} Additional HTTP request headers.\n *  - context {object} The value of this provided for the call of the callbacks\n *  - converter {function(data,XHR)} A function that returns the transformed value of the response\n *\n * \n * You may also give a callback as a second parameter. This callback is executed when the request is complete whether in failure or success.\n * On success, it receives the returned request data, as well as the XMLHttpRequest object.\n * On failure, the first parameter will be a Error object describing the error.\n * To check if a request is in failure :\n * <pre><code>EThing.request(options,function(data,xhr){\n *     if(data instanceof EThing.Error){\n *       // an error occurs, print the associated message\n *       console.log(data.message);\n *     }\n *   })`\n * </code></pre>\n *\n *\n * This function returns a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object} object.\n *\n * The done|fail|always functions take the same parameters than the {@link http://api.jquery.com/category/deferred-object/|jQuery version}.\n *\n *\n *\n * @method EThing.request\n * @param {string|object} options a set of key/value pairs that configure the request. If an URL is given, a GET request with the default options is made.\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}\n * @example\n * // GET request\n * EThing.request('/resources') // is equivalent to EThing.list()\n *\n * // pass an object to make more complex request\n * // store some data in a file\n * EThing.request({\n *   url: '/files/'+fileId,\n *   method: 'PUT',\n *   data: 'some content here ...',\n *   contentType: 'text/plain'\n * })\n * .done(function(file){\n *   console.log(\"the content was stored in the file \"+file.name());\n * })\n * .fail(function(error){\n *   console.log(\"an error occurs : \"+error.message);\n * });\n */\n// opt : same as ajax options or an url\nEThing.request = function(opt,callback){\n\tvar d = ajax(opt);\n\t\n\tif(typeof callback == 'function') {\n\t\td.always(function(){\n\t\t\tcallback.apply(this,Array.prototype.slice.call(arguments));\n\t\t});\n\t}\n\t\n\t// if sync return the result instead of the deferred object !\n\tif(opt.synchronous){\n\t\tvar result = null;\n\t\td.always(function(r){\n\t\t\tresult = r;\n\t\t});\n\t\treturn result;\n\t} else {\n\t\treturn d;\n\t}\n}\n\n\n/**\n*\n*/\nEThing.apiRequestPrefilter = function(handler){\n\tapiRequestPrefilterHandler = handler;\n}\n/**\n * Register a handler to be called just before API requests is sent.\n *\n * @method EThing.ajaxSend\n * @param {function(XHR)} handler The function to be invoked.\n */\nEThing.ajaxSend = function(handler){\n\tif(typeof handler == 'function'){\n\t\tajaxSendHandlers.push(handler);\n\t}\n}\n/**\n * Register a handler to be called when API requests complete.\n *\n * @method EThing.ajaxComplete\n * @param {function(data,XHR,options)} handler The function to be invoked.\n */\nEThing.ajaxComplete = function(handler){\n\tif(typeof handler == 'function'){\n\t\tajaxCompleteHandlers.push(handler);\n\t}\n}\n/**\n * Register a handler to be called when API requests complete successfully.\n *\n * @method EThing.ajaxSuccess\n * @param {function(data,XHR,options)} handler The function to be invoked.\n */\nEThing.ajaxSuccess = function(handler){\n\tif(typeof handler == 'function'){\n\t\tajaxSuccessHandlers.push(handler);\n\t}\n}\n/**\n * Register a handler to be called when API requests complete with an error.\n *\n * @method EThing.ajaxError\n * @param {function(data,XHR,options)} handler The function to be invoked.\n */\nEThing.ajaxError = function(handler){\n\tif(typeof handler == 'function'){\n\t\tajaxErrorHandlers.push(handler);\n\t}\n}\n\n\n\n\n\n\n/**\n * This function get the available resources. A filter may be given to retrieve resources with specific attributes (see the HTTP API for more details).\n * @method EThing.list\n * @param {string} [query] Query string for searching resources\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @example\n * // get all the resources\n * EThing.list().done(function(resources){\n *     console.log(resources);\n * })\n *\n * // get only File & Table resources\n * EThing.list('type == \"File\" or type == \"Table\"').done(function(resources){\n *     console.log(resources);\n * })\n */\nEThing.list = EThing.find = function(a,b)\n{\n\tvar query = null, callback = null;\n\t\n\tif(arguments.length==1){\n\t\tif(typeof arguments[0] == 'function')\n\t\t\tcallback = arguments[0];\n\t\telse\n\t\t\tquery = arguments[0];\n\t}\n\telse if(arguments.length>=2){\n\t\tquery = arguments[0];\n\t\tcallback = arguments[1];\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/resources?' + utils.param({'q':query}),\n\t\t'method': 'GET',\n\t\t'dataType': 'json',\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n};\n\n\n/**\n * Gets a resource by its id.\n *\n * @method EThing.get\n * @param {string|EThing.Resource} resourceIdentifier\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @example\n * // get a resource by its id\n * EThing.get(\"54516eb\").done(function(resource){\n *     console.log('the name is ' + resource.name());\n * })\n */\nEThing.get = function(a,b)\n{\n\tvar context;\n\tif(a instanceof EThing.Resource){\n\t\tcontext = a;\n\t\ta = a.id();\n\t}\n\telse if(!utils.isId(a)) {\n\t\tthrow \"First argument must be a Resource object or a Resource id : \"+a;\n\t\treturn;\n\t}\n\t\n\tvar callback = b;\n\t\n\treturn EThing.request({\n\t\t'url': '/resources/' + a,\n\t\t'dataType': 'json',\n\t\t'method': 'GET',\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n};\n\n\n/**\n * Gets an object containing informations about space usage :\n *  - used {number} the amount of space used in bytes\n *  - quota_size {number} the maximum space authorized in bytes\n *\n * @method EThing.usage\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @example\n * // get the occupied space :\n * EThing.usage().done(function(usage){\n *     console.log('space used : ' + (100 * usage.used / usage.quota_size) );\n * })\n */\nEThing.usage = function(a)\n{\n\tvar callback = a;\n\t\n\treturn EThing.request({\n\t\t'url': '/usage',\n\t\t'dataType': 'json',\n\t\t'method': 'GET'\n\t},callback);\n};\n\n\n\n\n\n\n\n\n\n/*\n * AUTH\n */\n\nvar NoAuth = function(a){ return a; };\n\n\n// private\nvar _resource = null,\n\t_scope = null,\n\t_authType = null,\n\t_processAuth = NoAuth; // function(xhr|url) -> return xhr|url\n\n\n\n/**\n * @namespace EThing.auth\n */\n\nEThing.auth = {};\n\n\n\n/**\n * Returns true if the authentication process has been successful.\n * @method EThing.auth.isAuthenticated\n * @returns {boolean}\n */\nEThing.auth.isAuthenticated = function(){\n\treturn !!_authType;\n}\n\n/**\n * Returns the authenticated app. Only available with app's apikey authentication.\n * @method EThing.auth.getApp\n * @returns {EThing.App} the authenticated app or null.\n */\nEThing.auth.getApp = function(){\n\treturn _resource instanceof EThing.App ? _resource : null;\n}\n\n/**\n * Returns the authenticated app. Only available with devices's apikey authentication.\n * @method EThing.auth.getDevice\n * @returns {EThing.Device} the authenticated device or null.\n */\nEThing.auth.getDevice = function(){\n\treturn _resource instanceof EThing.Device ? _resource : null;\n}\n\n/**\n * Returns the authenticated resource. Only available with apikey authentication.\n * @method EThing.auth.getResource\n * @returns {EThing.Resource} the authenticated resource or null.\n */\nEThing.auth.getResource = function(){\n\treturn _resource;\n}\n\n/**\n * Returns the scope of the current authentication\n * @method EThing.auth.getScope\n * @returns {string} the scope. May be an empty string if no permissions is set. May be null if full permissions.\n */\nEThing.auth.getScope = function(){\n\treturn _scope;\n}\n\n\n\n/**\n * Reset authentication. You must restart an authentication process to make API calls again.\n * @method EThing.auth.reset\n */\nEThing.auth.reset = function(){\n\t_resource = null;\n\t_authType = null;\n\t_scope = null;\n\t_processAuth = NoAuth;\n}\n\n\n\n\nEThing.auth.setApiKey = function(apiKey){\n\t\n\tEThing.auth.reset();\n\t\n\t_processAuth = function(xhrOrUrl){\n\t\t\n\t\tif(typeof xhrOrUrl == 'string')\n\t\t\txhrOrUrl = EThing.utils.insertParam(xhrOrUrl, 'api_key', apiKey);\n\t\telse \n\t\t\txhrOrUrl.setRequestHeader('X-API-KEY', apiKey);\n\t\t\n\t\treturn xhrOrUrl;\n\t};\n\t\n};\n\nEThing.auth.setBasicAuth = function(login, password){\n\t\n\tEThing.auth.reset();\n\t\n\t_processAuth = function(xhrOrUrl){\n\t\t\n\t\tif(typeof xhrOrUrl == 'string')\n\t\t\txhrOrUrl = xhrOrUrl.replace(/\\/\\/([^:]+:[^@]+@)?/, '//'+login+':'+password+'@');\n\t\telse \n\t\t\txhrOrUrl.setRequestHeader(\"Authorization\", \"Basic \" + utils.btoa(login + \":\" + password));\n\t\t\n\t\treturn xhrOrUrl;\n\t};\n};\n\n\n\n\n/**\n * Initialize the eThing library.\n *\n * @method EThing.initialize\n * @param {Object} options\n * @param {number} options.serverUrl The URL of your eThing server (e.g. http://hostname:8000 ).\n * @param {number} [options.apiKey] Authenticate with an API key.\n * @param {number} [options.login] Basic Authentication login (Should be used only server side i.e. NodeJS).\n * @param {number} [options.password] Basic Authentication password (Should be used only server side i.e. NodeJS).\n * @param {function(EThing.Error)} [errorFn] it is executed on authentication error.\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}\n * @fires EThing#ething.authenticated\n * @example\n *\n * EThing.initialize({\n *    serverUrl: 'http://hostname:8000',\n *    apiKey: 'a4e28b3c-1f05-4a62-95f7-c12453b66b3c'\n *  }, function(){\n *    // on authentication success\n *    alert('connected !');\n *  }, function(error) {\n *    // on authentication error\n *    alert(error.message);\n *  });\n *\n */\nEThing.initialize = function(options, successFn, errorFn){\n\t\n\tEThing.auth.reset();\n\t\n\toptions = extend({\n\t\tserverUrl: null,\n\t\t// auth apikey\n\t\tapiKey: null,\n\t\t// auth basic\n\t\tlogin: 'ething',\n\t\tpassword:null\n\t},options || {});\n\t\n\tif(options.serverUrl)\n\t\tEThing.config.serverUrl = options.serverUrl;\n\t\n\t\n\tif(options.apiKey)\n\t\tEThing.auth.setApiKey(options.apiKey);\n\telse if(options.login && options.password)\n\t\tEThing.auth.setBasicAuth(options.login, options.password);\n\t\n\treturn EThing.request({\n\t\t'url': '/auth',\n\t\t'dataType': 'json',\n\t\t'context': EThing,\n\t\t'converter': function(data){\n\t\t\t_authType = data.type;\n\t\t\tif(data.resource)\n\t\t\t\t_resource = EThing.instanciate(data.resource);\n\t\t\tif(data.scope)\n\t\t\t\t_scope = data.scope;\n\t\t}\n\t}).done(function(){\n\t\t\n\t\tauthenticatedCb_.forEach(function(cb){\n\t\t\tcb.call(EThing);\n\t\t});\n\t\t\n\t\tEThing.trigger('ething.authenticated');\n\t}).done(successFn).fail(errorFn);\n\t\n}\n\n\n/**\n * Register a handler to be executed once the authentication is complete.\n *\n * @method EThing.authenticated\n * @param {function()} callback it is executed on authentication success.\n *\n */\nvar authenticatedCb_ = [];\nEThing.authenticated = function(callback){\n\t\n\tif(typeof callback == 'function'){\n\t\tauthenticatedCb_.push(callback);\n\t\t\n\t\tif(EThing.auth.isAuthenticated()){\n\t\t\tcallback.call(EThing);\n\t\t}\n\t}\n}\n\nmodule.exports = EThing;\n\n","\nvar utils = require(\"./utils.js\");\nvar EventEngine = require(\"./eventEngine.js\");\nvar DeferredObject = require(\"./deferredObject.js\");\nvar EThing = require(\"./core.js\");\n\n\n/**\n * Base class of all the resources\n * @protected\n * @class\n * @memberOf EThing\n * @param {object} json\n */\nvar Resource = function (json)\n{\n\tDeferredObject.call(this);\n\t\n\tEventEngine(this);\n\t\n\tthis._fromJson(json, true);\n}\nutils.inherits(Resource,DeferredObject);\n\n// loader\nResource.prototype._fromJson = function(json, noTrigger){\n\t\n\tvar updated = this._json && json && this._json.modifiedDate && json.modifiedDate && this._json.modifiedDate !== json.modifiedDate;\n\tvar updatedKeys = [];\n\t\n\tjson = utils.extend({\n\t\tname:null,\n\t\tid:null,\n\t\ttype:null,\n        extends: [],\n\t\tcreatedBy:null,\n\t\tcreatedDate: 0,\n\t\tmodifiedDate: 0,\n\t\tdata: null,\n\t\tdescription: ''\n\t}, json || {});\n\t\n\tif(!noTrigger && updated) {\n\t\t// list the kays that have been updated\n\t\tObject.keys(json).forEach(function(key){\n\t\t\tif((typeof this._json[key] === 'undefined') || !utils.isEqual(json[key],this._json[key])){\n\t\t\t\tupdatedKeys.push(key);\n\t\t\t}\n\t\t},this);\n\t}\n\t\n\tthis._json = json;\n\t\n\tif(!noTrigger && updated) {\n\t\t//console.log('resource updated '+this.name());\n\t\tthis.trigger('updated', [updatedKeys]);\n\t\tEThing.trigger('ething.resource.updated',[this, updatedKeys]);\n\t}\n\t\n\treturn updated;\n}\n\n\n/**\n *  Returns the representation of this instance\n * @this {EThing.Resource}\n * @returns {object}\n */\nResource.prototype.json = function(){\n\treturn this._json;\n}\n\n/**\n * Return true if the resource is of the given type.\n * @this {EThing.Resource}\n * @param {string} type\n * @returns {boolean}\n */\nResource.prototype.isTypeof = function(type) {\n\treturn this._json.extends.indexOf(type) !== -1;\n}\n\n// path accessors\n/**\n * Returns the name of this resource. A name is constructed as __PathName/FileName__.\n * To get only the FileName, see {@link EThing.Resource#basename}.\n * To get only the PathName, see {@link EThing.Resource#dirname}.\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.name = function() {\n\treturn this._json.name;\n}\n/**\n * Returns the path of this resource\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.dirname = function() {\n\treturn EThing.Resource.dirname(this._json.name);\n}\n/**\n * Returns the basename of this resource\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.basename = function() {\n\treturn EThing.Resource.basename(this._json.name);\n}\n/**\n * Returns the extension of this resource\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.extension = function(){\n\treturn EThing.Resource.extension(this._json.name);\n}\n/**\n * Returns the id of this resource. This id is unique and immutable.\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.id = function(){\n\treturn this._json.id;\n}\n/**\n * Returns the id of the Resource which creates it if any, or returns null.\n * @this {EThing.Resource}\n * @returns {string|null}\n */\nResource.prototype.createdBy = function(){\n\treturn this._json.createdBy;\n}\n\n/**\n *  Returns the type of this resource :\n *  - \"File\"\n *  - \"Table\"\n *  - \"App\"\n *  - \"Device\"\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.type = function() {\n\treturn this._json.type;\n}\n\n/**\n *  Returns the types this resource depends on\n * @this {EThing.Resource}\n * @returns {string[]}\n */\nResource.prototype.types = function() {\n\treturn this._json.extends || [];\n}\n\n/**\n *  Returns the type of this resource :\n *  - \"File\"\n *  - \"Table\"\n *  - \"App\"\n *  - \"Device\"\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.baseType = function() {\n\tt = this.types()\n\treturn t[t.length - 1];\n}\n\n/**\n * Create time for this resource\n * @this {EThing.Resource}\n * @returns {Date}\n */\nResource.prototype.createdDate = function() {\n\treturn new Date(this._json.createdDate);\n}\nResource.prototype.ctime = function(){\n\treturn this.createdDate();\n}\n\n/**\n * Last time this resource was modified\n * @this {EThing.Resource}\n * @returns {Date}\n */\nResource.prototype.modifiedDate = function() {\n\treturn new Date(this._json.modifiedDate);\n}\nResource.prototype.mtime = function(){\n\treturn this.modifiedDate();\n}\n\n/**\n * Tells if this resource is publicly available.\n * @this {EThing.Resource}\n * @returns {boolean|string}\n */\nResource.prototype.public = function() {\n\treturn this._json.public || false;\n}\n\n/**\n * Returns the data attached to this resource.\n * @param {string} [name] an optional data attribute name.\n * @param {} [defaultValue] a default value if the attribute was not found.\n * @this {EThing.Resource}\n * @returns {object|null}\n */\nResource.prototype.data = function(name, defaultValue) {\n\tif(typeof name == 'undefined')\n\t\treturn this._json.data;\n\telse {\n\t\treturn this._json.data.hasOwnProperty(name) ? this._json.data[name] : defaultValue;\n\t}\n}\n\n/**\n * Returns the attributes to this resource.\n * @param {string} [name] an optional attribute name.\n * @this {EThing.Resource}\n * @returns {object|null}\n */\nResource.prototype.attr = function(name) {\n\tif(typeof name == 'undefined')\n\t\treturn this._json;\n\telse {\n\t\treturn this._json.hasOwnProperty(name) ? this._json[name] : null;\n\t}\n}\n\n/**\n * Returns true if the attribute exists for this resource.\n * @param {string} name attribute name.\n * @this {EThing.Resource}\n * @returns {boolean}\n */\nResource.prototype.hasAttr = function(name) {\n\treturn this._json.hasOwnProperty(name);\n}\n\n/**\n * Returns the description of this resource\n * @this {EThing.Resource}\n * @returns {string}\n */\nResource.prototype.description = function() {\n\treturn this._json.description || \"\";\n}\n\n// resource modificators (async)\n/**\n * Remove this resource.\n * @this {EThing.Resource}\n * @param {Boolean} [removeChildren] When true, the children are also removed. Default to false.\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Resource} The instance on which this method was called.\n * @fires EThing#ething.resource.removed\n * @example\n * resource.remove().done(function(){\n *   // the resource was successfully removed\n * });\n */\nResource.prototype.remove = function(removeChildren, callback){\n\treturn this.deferred(function(){\n\t\t\treturn Resource.remove(this, callback);\n\t\t});\n}\n\nResource.prototype.update = function(callback){\n\treturn this.deferred(function(){\n\t\t\treturn EThing.get(this, callback);\n\t\t});\n}\n\n/**\n * Update this resource attributes\n * @this {EThing.Resource}\n * @param {} properties\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Resource} The instance on which this method was called.\n * @example\n * resource.set({\n *   name: \"newName.txt\"\n * }).done(function(){\n *   console.log(\"the resource was successfully renamed to :\"+this.name());\n * });\n */\nResource.prototype.set = function(properties, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Resource.set.apply(EThing, args);\n\t\t});\n}\n/**\n * Attaches persistant data to this resource\n * @this {EThing.Resource}\n * @param {object} data\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Resource} The instance on which this method was called.\n * @example\n * resource.setData({\n *   \"key\": \"value\"\n * }).done(function(){\n *   // success\n * });\n * \n * // you can also write :\n * resource.setData(\"key\", \"value\").done(function(){\n *   // success\n * });\n */\nResource.prototype.setData = function(data, callback){\n\t\n\tif(typeof data === 'string' && typeof callback != 'function'){\n\t\tvar key = data, value = callback, callback = arguments[2];\n\t\tdata = {};\n\t\tdata[key] = value;\n\t}\n\t\n\treturn this.set({'data':data},callback);\n}\n\n\n\n\n\n\n\n\n/*\nResource,callback\n*/\nResource.remove = function(a,removeChildren,callback)\n{\n\tvar context;\n\tif(a instanceof Resource){\n\t\tcontext = a;\n\t\ta = a.id();\n\t}\n\telse if(!utils.isId(a)) {\n\t\tthrow \"First argument must be a Resource object or a Resource id : \"+a;\n\t\treturn;\n\t}\n\t\n\tif(arguments.length==2 && typeof removeChildren === 'function'){\n\t\tcallback = removeChildren;\n\t\tremoveChildren = false;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/resources/' + a + '?' + utils.param({'children':removeChildren}),\n\t\t'method': 'DELETE',\n\t\t'context': context\n\t},callback).done(function(){\n\t\tEThing.trigger('ething.resource.removed',[a]);\n\t});\n};\n\n\n\n/*\nResource,data,callback\n*/\nResource.set = function(a,b,c){\n\tvar context;\n\t\n\tif(!utils.isPlainObject(b) || !b){\n\t\tthrow 'Second argument must be a unempty object !';\n\t\treturn;\n\t}\n\t\n\tif(a instanceof Resource){\n\t\tcontext = a;\n\t\ta = a.id();\n\t}\n\telse if(!utils.isId(a)) {\n\t\tthrow \"First argument must be a Resource object or a Resource id : \"+a;\n\t\treturn;\n\t}\n\t\n\tvar callback = c;\n\t\n\treturn EThing.request({\n\t\t'url': '/resources/' + a,\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': b,\n\t\t'context': context,\n\t\t'headers': {\n\t\t\t\"X-HTTP-Method-Override\": \"PATCH\"\n\t\t},\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n};\n\n\n\n\n\n\n\n/*\n* TOOLS\n*/\nResource.dirname = function(f) {\n\tvar s = f.replace(/\\/[^\\/]*\\/?$/, '');\n\treturn ( s === f ) ? \"\" : s;\n}\nResource.basename = function(f) {\n\treturn f.replace( /.*\\//, '' );\n}\nResource.extension = function(f){\n\treturn f.indexOf('.')>=0 ? f.split('.').pop() : '';\n}\nResource.fnmatch = function fnmatch(pattern, path) {\n\t\n\tvar patternTab = pattern.split(' ');\n\tvar parsedPattern, regexp;\n\t\n\tfor(var i=0; i<patternTab.length; i++){\n\t\tif(patternTab[i] == '') continue;\n\t\t\n\t\tparsedPattern = '^' + patternTab[i].replace(/\\//g, '\\\\/').\n\t\treplace(/\\*\\*/g, '(\\\\/[^\\\\/]+)*').\n\t\treplace(/\\*/g, '[^\\\\/]+').\n\t\treplace(/((?!\\\\))\\?/g, '$1.') + '$';\n\t\t\n\t\tparsedPattern = '^' + parsedPattern + '$';\n\t\t\n\t\tregexp = new RegExp(parsedPattern);\n\t\tif( path.match(regexp) != null ) return true;\n\t}\n\treturn false;\n};\n\n\nEThing.Resource = Resource;\n\nmodule.exports = Resource;\n","\n\nfunction foreach(arr, handler) {\n\tif (Array.isArray(arr)) {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\thandler(arr[i]);\n\t\t}\n\t}\n\telse\n\t\thandler(arr);\n}\n\nfunction D(fn) {\n\tvar status = 'pending',\n\t\tdoneFuncs = [],\n\t\tfailFuncs = [],\n\t\tprogressFuncs = [],\n\t\tresultArgs = null,\n\n\ttuples = [\n\t\t\t// action, add listener,\n\t\t\t[ \"resolve\", \"done\"],\n\t\t\t[ \"reject\", \"fail\"],\n\t\t\t[ \"notify\", \"progress\"]\n\t\t],\n\t\t\n\tpromise = {\n\t\tdone: function() {\n\t\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\t\t// skip any undefined or null arguments\n\t\t\t\tif (!arguments[i]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Array.isArray(arguments[i])) {\n\t\t\t\t\tvar arr = arguments[i];\n\t\t\t\t\tfor (var j = 0; j < arr.length; j++) {\n\t\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\t\tif (status === 'resolved') {\n\t\t\t\t\t\t\tarr[j].apply(this, resultArgs);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdoneFuncs.push(arr[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\tif (status === 'resolved') {\n\t\t\t\t\t\targuments[i].apply(this, resultArgs);\n\t\t\t\t\t}\n\n\t\t\t\t\tdoneFuncs.push(arguments[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this;\n\t\t},\n\n\t\tfail: function() {\n\t\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\t\t// skip any undefined or null arguments\n\t\t\t\tif (!arguments[i]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Array.isArray(arguments[i])) {\n\t\t\t\t\tvar arr = arguments[i];\n\t\t\t\t\tfor (var j = 0; j < arr.length; j++) {\n\t\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\t\tif (status === 'rejected') {\n\t\t\t\t\t\t\tarr[j].apply(this, resultArgs);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfailFuncs.push(arr[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\tif (status === 'rejected') {\n\t\t\t\t\t\targuments[i].apply(this, resultArgs);\n\t\t\t\t\t}\n\n\t\t\t\t\tfailFuncs.push(arguments[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this;\n\t\t},\n\n\t\talways: function() {\n\t\t\treturn this.done.apply(this, arguments).fail.apply(this, arguments);\n\t\t},\n\n\t\tprogress: function() {\n\t\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\t\t// skip any undefined or null arguments\n\t\t\t\tif (!arguments[i]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Array.isArray(arguments[i])) {\n\t\t\t\t\tvar arr = arguments[i];\n\t\t\t\t\tfor (var j = 0; j < arr.length; j++) {\n\t\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\t\tif (status === 'pending') {\n\t\t\t\t\t\t\tprogressFuncs.push(arr[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// immediately call the function if the deferred has been resolved\n\t\t\t\t\tif (status === 'pending') {\n\t\t\t\t\t\tprogressFuncs.push(arguments[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this;\n\t\t},\n\n\t\t/*then: function() {\n\t\t\t// fail callbacks\n\t\t\tif (arguments.length > 1 && arguments[1]) {\n\t\t\t\tthis.fail(arguments[1]);\n\t\t\t}\n\n\t\t\t// done callbacks\n\t\t\tif (arguments.length > 0 && arguments[0]) {\n\t\t\t\tthis.done(arguments[0]);\n\t\t\t}\n\n\t\t\t// notify callbacks\n\t\t\tif (arguments.length > 2 && arguments[2]) {\n\t\t\t\tthis.progress(arguments[2]);\n\t\t\t}\n\t\t\t\n\t\t\treturn this;\n\t\t},*/\n\t\t\n\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\n\t\t\tvar fns = arguments;\n\t\t\treturn D( function( newDefer ) {\n\t\t\t\t\n\t\t\t\ttuples.forEach(function( tuple, i ) {\n\t\t\t\t\tvar fn = (typeof fns[ i ] == 'function' ) && fns[ i ];\n\n\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\n\t\t\t\t\tdeferred[ tuple[ 1 ] ]( function() {\n\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n\t\t\t\t\t\tif ( returned && (typeof returned.promise == 'function' ) ) {\n\t\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t\t.progress( newDefer.notify )\n\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t\t.fail( newDefer.reject );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + \"With\" ](\n\t\t\t\t\t\t\t\tthis === promise ? newDefer.promise() : this,\n\t\t\t\t\t\t\t\tfn ? [ returned ] : arguments\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t\tfns = null;\n\t\t\t} ).promise();\n\t\t},\n\n\t\tpromise: function(obj) {\n\t\t\tif (obj == null) {\n\t\t\t\treturn promise;\n\t\t\t} else {\n\t\t\t\tfor (var i in promise) {\n\t\t\t\t\tobj[i] = promise[i];\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t},\n\n\t\tstate: function() {\n\t\t\treturn status;\n\t\t},\n\n\t\tdebug: function() {\n\t\t\tconsole.log('[debug]', doneFuncs, failFuncs, status);\n\t\t},\n\n\t\tisRejected: function() {\n\t\t\treturn status === 'rejected';\n\t\t},\n\n\t\tisResolved: function() {\n\t\t\treturn status === 'resolved';\n\t\t}\n\t},\n\n\tdeferred = {\n\t\tresolveWith: function(context) {\n\t\t\tif (status === 'pending') {\n\t\t\t\tstatus = 'resolved';\n\t\t\t\tvar args = resultArgs = (arguments.length > 1) ? arguments[1] : [];\n\t\t\t\tfor (var i = 0; i < doneFuncs.length; i++) {\n\t\t\t\t\tdoneFuncs[i].apply(context, args);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\trejectWith: function(context) {\n\t\t\tif (status === 'pending') {\n\t\t\t\tstatus = 'rejected';\n\t\t\t\tvar args = resultArgs = (arguments.length > 1) ? arguments[1] : [];\n\t\t\t\tfor (var i = 0; i < failFuncs.length; i++) {\n\t\t\t\t\tfailFuncs[i].apply(context, args);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tnotifyWith: function(context) {\n\t\t\tif (status === 'pending') {\n\t\t\t\tvar args = resultArgs = (arguments.length > 1) ? arguments[1] : [];\n\t\t\t\tfor (var i = 0; i < progressFuncs.length; i++) {\n\t\t\t\t\tprogressFuncs[i].apply(context, args);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tresolve: function() {\n\t\t\treturn this.resolveWith(this, arguments);\n\t\t},\n\n\t\treject: function() {\n\t\t\treturn this.rejectWith(this, arguments);\n\t\t},\n\n\t\tnotify: function() {\n\t\t\treturn this.notifyWith(this, arguments);\n\t\t}\n\t}\n\n\tvar obj = promise.promise(deferred);\n\n\tif (fn) {\n\t\tfn.apply(obj, [obj]);\n\t}\n\n\treturn obj;\n}\n\nD.when = function() {\n\tif (arguments.length < 2) {\n\t\tvar obj = arguments.length ? arguments[0] : undefined;\n\t\tif (obj && (typeof obj.isResolved === 'function' && typeof obj.isRejected === 'function')) {\n\t\t\treturn obj.promise();\t\t\t\n\t\t}\n\t\telse {\n\t\t\treturn D().resolve(obj).promise();\n\t\t}\n\t}\n\telse {\n\t\treturn (function(args){\n\t\t\tvar df = D(),\n\t\t\t\tsize = args.length,\n\t\t\t\tdone = 0,\n\t\t\t\trp = new Array(size);\t// resolve params: params of each resolve, we need to track down them to be able to pass them in the correct order if the master needs to be resolved\n\n\t\t\tfor (var i = 0; i < args.length; i++) {\n\t\t\t\t(function(j) {\n\t\t\t\t\tvar obj = null;\n\t\t\t\t\t\n\t\t\t\t\tif (args[j].done) {\n\t\t\t\t\t\targs[j].done(function() { rp[j] = (arguments.length < 2) ? arguments[0] : arguments; if (++done == size) { df.resolve.apply(df, rp); }})\n\t\t\t\t\t\t.fail(function() { df.reject(arguments); });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj = args[j];\n\t\t\t\t\t\targs[j] = new Deferred();\n\t\t\t\t\t\t\n\t\t\t\t\t\targs[j].done(function() { rp[j] = (arguments.length < 2) ? arguments[0] : arguments; if (++done == size) { df.resolve.apply(df, rp); }})\n\t\t\t\t\t\t.fail(function() { df.reject(arguments); }).resolve(obj);\n\t\t\t\t\t}\n\t\t\t\t})(i);\n\t\t\t}\n\n\t\t\treturn df.promise();\n\t\t})(arguments);\n\t}\n}\n\nmodule.exports = D;\n\n","var EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\n\n\n\n\n/**\n * Constructs a Device instance from an object decribing a device. Should not be called directly. Use instead {@link EThing.list}.\n * @protected\n * @class The Device resource handle a device\n * @memberof EThing\n * @extends EThing.Resource\n * @param {object} json\n */\nvar Device = function(json)\n{\n\tResource.call(this, json);\n\t\n\t(this._json.methods || []).forEach(function(operationId){\n\t\tif(typeof this[operationId] == 'undefined'){\n\t\t\tvar self = this;\n\t\t\t\n\t\t\tthis[operationId] = function(data, binary, callback){\n\t\t\t\tvar args = [].slice.call(arguments);\n\t\t\t\treturn this.deferred(function(){\n\t\t\t\t\targs.unshift(operationId);\n\t\t\t\t\targs.unshift(this);\n\t\t\t\t\treturn Device.execute.apply(EThing, args);\n\t\t\t\t});\n\t\t\t};\n\t\t\t\n\t\t\tthis[operationId].getApi = function(callback){\n\t\t\t\treturn Device.getApi(self, operationId, callback);\n\t\t\t};\n\t\t\t\n\t\t\tthis[operationId].executeUrl = function(data){\n\t\t\t\treturn self.executeUrl(operationId, data);\n\t\t\t};\n\t\t}\n\t}, this);\n}\nutils.inherits(Device, Resource);\n\n\n/**\n * \n * @this {EThing.Device}\n * @returns {string|null} Return either a string containing information about the location (coordinates, place, room ...) or null if no location is defined for this device.\n */\nDevice.prototype.location = function() {\n  return this._json.location || null;\n}\n\n/**\n * \n * @this {EThing.Device}\n * @returns {boolean} Return true if the device is connected.\n */\nDevice.prototype.connected = function() {\n\treturn !!this._json.connected;\n}\n\n/**\n * \n * @this {EThing.Device}\n * @returns {Date|null}\n */\nDevice.prototype.lastSeenDate = function() {\n  return (typeof this._json.lastSeenDate == 'string') ? new Date(this._json.lastSeenDate) : null;\n}\n\n/**\n * \n * @this {EThing.Device}\n * @returns {boolean}\n */\nDevice.prototype.hasBattery = function() {\n  return (typeof this._json.battery == \"number\") && this._json.battery >= 0 ;\n}\n\n/**\n * \n * @this {EThing.Device}\n * @returns {number}\n */\nDevice.prototype.battery = function() {\n  return this.hasBattery() ? this._json.battery : null ;\n}\n\n/**\n * List the available methods on this device.\n * @this {EThing.Device}\n * @returns {string[]}\n */\nDevice.prototype.methods = function(){\n\treturn this._json.methods || [];\n}\n\n/**\n * List the available interfaces on this device.\n * @this {EThing.Device}\n * @returns {string[]}\n */\nDevice.prototype.interfaces = function(){\n\treturn this._json.interfaces || [];\n}\n\n\n/**\n * Execute an operation on this device.\n * @this {EThing.Device}\n * @param {string} operationId\n * @param {object|array|anything} [data] the optional arguments required by the operation\n * @param {boolean} [binary] if true, return the content as binary data (as Blob in a browser, or Buffer in NodeJs). The arguments must be provided.\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Device} The instance on which this method was called.\n * @example\n * // if this device is a thermometer :\n * device.execute('getTemperature').done(function(data){\n *   // success, handle the data here\n * });\n *\n * // if this device is a switch :\n * device.execute('setState', {\n * \t state: true\n * });\n *\n * // you can also pass the arguments as an array :\n * device.execute('setState', [true]);\n * \n * // or as is :\n * device.execute('setState', true);\n * \n * \n * // you may also do :\n * device.getTemperature().done(function(data){\n *   // success, handle the data here\n * });\n *\n */\nDevice.prototype.execute = function(){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Device.execute.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Returns an url for executing an operation.\n * @this {EThing.Device}\n * @param {string} operationId\n * @param {object} [data] the optional data required by the operation\n * @returns {string} The url.\n * @example\n * \n * var image = new Image();\n * image.src = device.executeUrl('getImage');\n * document.body.appendChild(image);\n *\n */\nDevice.prototype.executeUrl = function(operationId, data){\n\tvar url = 'devices/'+this.id()+'/call/'+operationId;\n\t\n\tif(isPlainObject(data) && Object.keys(data).length !== 0){\n\t\turl += '?' + utils.param(data);\n\t}\n\t\n\treturn EThing.toApiUrl(url,true);\n}\n\n/**\n * Retrieve information about a specific method or all the methods available for this device.\n * @this {EThing.Device}\n * @param {string} [operationId] if set, only information about this operation will be returned\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Device} The instance on which this method was called.\n *\n */\nDevice.prototype.getApi = function(operationId, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\targs.unshift(this);\n\t\treturn Device.getApi.apply(EThing, args);\n\t});\n}\n\n\n\n\n\n/*\ndevice, operationId[, data ]\n*/\nDevice.execute = function(device, operationId, data, binary, callback){\n\t\n\tvar context;\n\t\n\tif(device instanceof Device){\n\t\tcontext = device;\n\t\tdevice = device.id();\n\t}\n\telse if(utils.isId(device))\n\t\tdevice = device;\n\telse {\n\t\tthrow \"First argument must be a Device object or a Device id !\";\n\t\treturn;\n\t}\n\t\n\tif(arguments.length == 4){\n\t\t\n\t\tif(typeof binary == 'function'){\n\t\t\tcallback = binary;\n\t\t\tbinary = undefined;\n\t\t}\n\t\t\n\t} else if(arguments.length == 3){\n\t\t\n\t\tif(typeof data == 'function'){\n\t\t\tcallback = data;\n\t\t\tdata = undefined;\n\t\t}\n\t\t\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/devices/' + device + '/call/' + operationId,\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': typeof data != 'undefined' && data!==null ? JSON.stringify(data) : undefined,\n\t\t'dataType': binary ? (utils.isNode ? 'buffer' : 'blob') : 'auto',\n\t\t'context': context\n\t},callback);\n\t\n};\n\n\n/*\ndevice[, operationId]\n*/\nDevice.getApi = function(device, operationId, callback){\n\t\n\tvar context;\n\t\n\tif(typeof operationId == 'function' && typeof callback == 'undefined'){\n\t\tcallback = operationId;\n\t\toperationId = undefined;\n\t}\n\t\n\tif(device instanceof Device){\n\t\tcontext = device;\n\t\tdevice = device.id();\n\t}\n\telse if(utils.isId(device))\n\t\tdevice = device;\n\telse {\n\t\tthrow \"First argument must be a Device object or a Device id !\";\n\t\treturn;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/devices/' + device + '/api' + (operationId?('/'+operationId):''),\n\t\t'method': 'GET',\n\t\t'context': context,\n\t\t'dataType': 'json'\n\t},callback);\n\t\n};\n\n\n/**\n * Creates a new device\n *\n * @method EThing.Device.create\n * @param {string} type the type of the device to create (ie: SSH, MQTT ...)\n * @param {object} attributes\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @fires EThing#ething.device.created\n * @example\n * EThing.Device.create('SSH', {\n *   host: \"localhost\",\n *   auth: {\n *     user: \"foo\",\n *     password: \"bar\"\n *   }\n * }).done(function(resource){\n *     console.log('the new SSH device has been created');\n * })\n */\nDevice.create = function(type, a,callback){\n\t\n\ta.type = type;\n\t\n\treturn EThing.request({\n\t\t'url': '/devices',\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': a,\n\t\t'converter': EThing.resourceConverter\n\t},callback).done(function(r){\n\t\tEThing.trigger('ething.device.created',[r]);\n\t});\n\t\n};\n\nEThing.Device = Device;\n\nmodule.exports = Device;\n\n","\nvar Deferred = require(\"./deferred.js\");\n\n\t\n// deferred engine\nvar DeferredObject = function(){\n\t\n\tvar resolvedDfr = Deferred().resolve(),\n\t\tqueue = [],\n\t\tself = this;\n\t\n\t\n\t['done','fail','always','progress','then','state','isRejected','isResolved'].forEach(function(fctname){\n\t\tthis[fctname] = function(){\n\t\t\t// get last deferred object in queue\n\t\t\tvar dfr = queue.length ? queue[queue.length-1].dfr : resolvedDfr;\n\t\t\t\n\t\t\tvar r = dfr[fctname].apply(self,Array.prototype.slice.call(arguments));\n\t\t\t\n\t\t\tif(typeof r == 'object' && fctname!=='then'){\n\t\t\t\t// dfr object\n\t\t\t\treturn self;\n\t\t\t} else {\n\t\t\t\treturn r; // state , isRejected, isResolved, then\n\t\t\t}\n\t\t}\n\t}, this);\n\tthis.promise = function(){\n\t\treturn self;\n\t}\n\t\n\tfunction processQueue(){\n\t\t\n\t\tfor(var i=0; i<queue.length; i++){\n\t\t\t\n\t\t\tvar dfr = queue[i].dfr,\n\t\t\t\tpending = queue[i].pending,\n\t\t\t\tfn = queue[i].fn;\n\t\t\t\n\t\t\tif(pending){\n\t\t\t\t\n\t\t\t\tqueue[i].pending = false;\n\t\t\t\t\n\t\t\t\tfn.call(self,self)\n\t\t\t\t\t.done(function(){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdfr.resolveWith(self,args);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(){\n\t\t\t\t\t\tdfr.rejectWith(self,Array.prototype.slice.call(arguments));\n\t\t\t\t\t})\n\t\t\t\t\t.progress(function(){\n\t\t\t\t\t\tdfr.notifyWith(self,Array.prototype.slice.call(arguments));\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\n\t\t\t\tif(dfr.isResolved() || dfr.isRejected()){\n\t\t\t\t\tqueue.splice(i, 1); // remove finished actions\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// else busy, wait for that element to finish\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tbreak;\n\t\t\t\n\t\t}\n\t}\n\t\n\tthis.deferred = function(action){\n\t\t\n\t\t// bind a new deferred object to this new action\n\t\tvar dfr = new Deferred();\n\t\t\n\t\t\n\t\tdfr.always(function(){\n\t\t\t// execute the next action\n\t\t\tprocessQueue();\n\t\t});\n\t\t\n\t\t\n\t\t// add this action to the queue \n\t\tqueue.push({\n\t\t\tfn: action,\n\t\t\tdfr: dfr,\n\t\t\tpending: true\n\t\t});\n\t\t\n\t\tprocessQueue();\n\t\t\n\t\treturn this; // chainable\n\t\t\n\t};\n\t\n}\n\nmodule.exports = DeferredObject;\n","\nvar Event = require(\"./event.js\");\n\nfunction EventEngine(obj){\n\t\n\tvar event_map = {};\n\t\n\tobj.on = function(events, handler) {\n\t\tif(typeof handler == 'function'){\n\t\t\tevents = events.split(' ');\n\t\t\tfor(var i=0; i<events.length; i++){\n\t\t\t\tvar event = events[i];\n\t\t\t\tif(event.length){\n\t\t\t\t\tif(!event_map[event]) event_map[event] = [];\n\t\t\t\t\tevent_map[event].push(handler);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tobj.off = function(events, handler) {\n\t\tevents = events.split(' ');\n\t\tfor(var i=0; i<events.length; i++){\n\t\t\tvar event = events[i];\n\t\t\tif(event.length && event_map[event]){\n\t\t\t\tif(typeof handler == 'function'){\n\t\t\t\t\tfor(var j=0; j<event_map[event].length; j++){\n\t\t\t\t\t\tif(event_map[event][j]===handler){\n\t\t\t\t\t\t\tevent_map[event].splice(j, 1);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tevent_map[event] = [];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tobj.one = function(events, handler) {\n\t\tif(typeof handler == 'function'){\n\t\t\tobj.on(events, function(){\n\t\t\t\tobj.off(events,handler);\n\t\t\t\thandler.apply(this,Array.prototype.slice.call(arguments));\n\t\t\t});\n\t\t}\n\t}\n\t\n\tobj.trigger = function(event, extraParameters){\n\t\tif(typeof event === 'string')\n\t\t\tevent = Event(event);\n\t\t\n\t\tvar type = event.type,\n\t\t\th = event_map[type] || [];\n\t\t\n\t\tfor(var i=0; i<h.length; i++){\n\t\t\tvar args = [event];\n\t\t\tif(Array.isArray(extraParameters))\n\t\t\t\targs = args.concat(extraParameters);\n\t\t\th[i].apply(obj,args);\n\t\t\t\n\t\t\tif(event.isImmediatePropagationStopped() || event.isPropagationStopped())\n\t\t\t\tbreak;\n\t\t}\n\t\treturn event;\n\t}\n\t\n\t\n}\n\nmodule.exports = EventEngine;","var utils = require(\"./utils.js\");\n\n\nfunction returnTrue() {\n\treturn true;\n}\n\nfunction returnFalse() {\n\treturn false;\n}\n\n\n/*\nEvent object\n*/\n\nvar Event = function( src, props ) {\n\n\t// Allow instantiation without the 'new' keyword\n\tif ( !( this instanceof Event ) ) {\n\t\treturn new Event( src, props );\n\t}\n\n\t// Event type\n\tthis.type = src;\n\n\t// Put explicitly provided properties onto the event object\n\tif ( props ) {\n\t\tutils.extend( this, props );\n\t}\n\n\t// Create a timestamp if incoming event doesn't have one\n\tthis.timeStamp = Date.now();\n\t\n};\n\nEvent.prototype = {\n\tconstructor: Event,\n\tisDefaultPrevented: returnFalse,\n\tisPropagationStopped: returnFalse,\n\tisImmediatePropagationStopped: returnFalse,\n\n\tpreventDefault: function() {\n\t\tthis.isDefaultPrevented = returnTrue;\n\t},\n\tstopPropagation: function() {\n\t\tthis.isPropagationStopped = returnTrue;\n\t},\n\tstopImmediatePropagation: function() {\n\t\tthis.isImmediatePropagationStopped = returnTrue;\n\t\tthis.stopPropagation();\n\t}\n};\n\n\n\n\t\nmodule.exports = Event;\n\n","\n/**\n * This library helps to organise your resources in a tree structure.\n * Folders do not exist explicitly in eThing. But this library emulate it.\n * Every resource must have a name set. A name is composed of a pathname followed by a filename.\n * The pathname represent the folder where the file is located.\n *\n * For instance, the following resources :\n *    - dir1/file1.txt\n *    - dir1/file2.txt\n *    - dir2/file3.txt\n *    - file4.txt\n *\n * could be reorganized into folders:\n *\n *     root\n *      |\n *      +--dir1\n *      |    +---file1.txt\n *      |    +---file2.txt\n *      |\n *      +--dir2\n *      |    +---file3.txt\n *      |\n *      +--file4.txt\n *\n * This way, it is convenient to find all the resources located in the same folder.\n *\n * @example\n * // list all the txt files in the dir1 folder\n * EThing.arbo.load(function(){\n *   // the next line may list Table that ends with \".txt\"\n *   console.log(EThing.arbo.findOne('dir1').children(/\\.txt/i));\n *   // better\n *   console.log(EThing.arbo.findOne('dir1').children(function(r){\n *     return (r instanceof EThing.File) && /\\.txt/i.test(r.name());\n *   }));\n * })\n *\n * @namespace {object} EThing.arbo\n */\n \n\nvar EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\nvar Deferred = require(\"./deferred.js\");\n\n\n\nvar resources = [],\n\tloaddfr = null,\n\troot = null;\n\n\n\n\n\n\n/**\n * This class is used in the {@link EThing.arbo} library. It emulates a tree structure using folders.\n * \n * @protected\n * @class\n * @memberof EThing\n * @extends EThing.Resource\n * @param {Object} json\n */\n// internal folder type\nvar Folder = function(json) {\n\t\n\tif(!json.id)\n\t\tjson.id = '/'+json.name; // just to avoid collision beetween native resource's id and Folder's id (ie: native resource's id never has '/' character)\n\t\n\tif(json.name==='')\n\t\tthis.isRoot = true;\n\t\n\tResource.call(this,utils.extend({\n\t\ttype:'Folder'\n\t},json));\n\t\n};\nutils.inherits(Folder,Resource);\n\n/*\n* Overriding some base methods \n*/\n\n// find the oldest createdDate\nFolder.prototype.createdDate = function() {\n\tvar l = this.find(),\n\t\tt = null;\n\tfor(var i=0; i<l.length; i++){\n\t\tif (t===null || t > l[i].createdDate())\n\t\t\tt = l[i].createdDate();\n\t}\n\treturn t;\n}\n\n// Find the newest modifiedDate\nFolder.prototype.modifiedDate = function() {\n\tvar l = this.find(),\n\t\tt = null;\n\tfor(var i=0; i<l.length; i++){\n\t\tif (t===null || t < l[i].modifiedDate())\n\t\t\tt = l[i].modifiedDate();\n\t}\n\treturn t;\n}\n\n\n/**\n * Remove all the resources under this folder.\n *\n * @this {EThing.Folder}\n * @param {function(EThing.Folder)} [callback] function executed once the folder is removed\n * @returns {EThing.Folder} The instance on which this method was called.\n */\nFolder.prototype.remove = function(callback) {\n\tvar self = this;\n\treturn this.deferred(function(){\n\t\t\tvar deferreds = [];\n\t\t\tthis.children().forEach(function(r){\n\t\t\t\tdeferreds.push( r.remove() );\n\t\t\t});\n\t\t\treturn Deferred.when.apply(Deferred, deferreds).done(function(){\n\t\t\t\tif(typeof callback == 'function')\n\t\t\t\t\tcallback.call(self);\n\t\t\t});\n\t\t});\n}\n\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.set = null;\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.setData = null;\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.description;\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.data;\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.createdBy;\n/**\n * This method is not applicable on folder\n * @private\n */\nFolder.prototype.extension = function(){\n\treturn '';\n};\n\n\n/**\n * List the resources and folders immediately located in this folder. This method only travels a single level down the tree.\n * See the method {@link EThing.Folder#find} to traverse down multiple levels to select descendant elements (grandchildren, etc.).\n *\n * A filter can be provided, his type must be one of the following :\n *   - function : function to test each resource. Invoked with arguments (EThing.Resource, relativeName). Return true to keep the resource, false otherwise.\n *   - string : only the resources that match the given relative name are returned (note: two resource can have the same name).\n *   - string[] : only the resources that match the given relative names are returned.\n *   - RegExp : only the resources satisfying this regular expression is returned.\n *  \n * @param {function(EThing.Resource,relativeName)|string|string[]|RegExp} [filter] if set, only the resources that match the filter are returned.\n * @this {EThing.Folder}\n * @returns {EThing.Resource[]}\n */\nFolder.prototype.children = function(filter_, type){\n\tvar fd = this._json.name.length ? (this._json.name+'/') : ''; // the root node has an empty name, no leading '/'\n\tvar list = find(new RegExp('^'+fd+'[^/]+$'));\n\tif(typeof filter_ != \"undefined\" && filter_)\n\t\tlist = list.filter(function(r){\n\t\t\tif(!type || r.type() === type){\n\t\t\t\tvar relativeName = r.name().substr(fd.length);\n\t\t\t\t\n\t\t\t\tif(typeof filter_ == 'function'){\n\t\t\t\t\treturn !!filter_.call(r,r,relativeName);\n\t\t\t\t}\n\t\t\t\telse if(typeof filter_ == 'string'){\n\t\t\t\t\treturn relativeName === filter_;\n\t\t\t\t}\n\t\t\t\telse if(Array.isArray(filter_)){\n\t\t\t\t\treturn filter_.indexOf(relativeName) >= 0;\n\t\t\t\t}\n\t\t\t\telse if(filter_ instanceof RegExp){\n\t\t\t\t\treturn filter_.test(relativeName);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\treturn list;\n}\n\n/**\n * Synonym of {@link EThing.Folder#children}\n * @this {EThing.Folder}\n * @returns {EThing.Resource[]}\n */\nFolder.prototype.ls = Folder.prototype.children;\n\n/**\n * List the resources and folders under this folder.\n * The find() and {@link EThing.Folder#children} methods are similar, except that the latter only travels a single level down the tree.\n *\n * A filter can be provided, his type must be one of the following :\n *   - function : function to test each resource. Invoked with arguments (EThing.Resource, relativeName). Return true to keep the resource, false otherwise.\n *   - string : only the resources that match the given relative name are returned (note: two resource can have the same name).\n *   - string[] : only the resources that match the given relative names are returned.\n *   - RegExp : only the resources satisfying this regular expression is returned.\n *  \n * @param {function(EThing.Resource,relativeName)|string|string[]|RegExp} [filter] if set, only the resources that match the filter are returned.\n * @this {EThing.Folder}\n * @returns {EThing.Resource[]}\n */\nFolder.prototype.find = function(filter_, type){ // deep find\n\tvar fd = this._json.name.length ? (this._json.name+'/') : ''; // the root node has an empty name, no leading '/'\n\tvar list = find(fd.length ? new RegExp('^'+fd) : new RegExp('^.+'));\n\tif(typeof filter_ != \"undefined\" && filter_)\n\t\tlist = list.filter(function(r){\n\t\t\tif(!type || r.type() === type){\n\t\t\t\tvar relativeName = r.name().substr(fd.length);\n\t\t\t\t\n\t\t\t\tif(typeof filter_ == 'function'){\n\t\t\t\t\treturn !!filter_.call(r,r,relativeName);\n\t\t\t\t}\n\t\t\t\telse if(typeof filter_ == 'string'){\n\t\t\t\t\treturn relativeName === filter_;\n\t\t\t\t}\n\t\t\t\telse if(Array.isArray(filter_)){\n\t\t\t\t\treturn filter_.indexOf(relativeName) >= 0;\n\t\t\t\t}\n\t\t\t\telse if(filter_ instanceof RegExp){\n\t\t\t\t\treturn filter_.test(relativeName);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\treturn list;\n}\n\n/**\n * Same as {@link EThing.Folder#find} except that it will return only one result (the first resource that match the filter) or null if nothing was found.\n * See {@link EThing.Folder#find} for more details about the argument.\n *  \n * @param {function(EThing.Resource,relativeName)|string|string[]|RegExp} [filter] if set, only the first resource that match the filter is returned.\n * @this {EThing.Folder}\n * @returns {EThing.Resource|null}\n */\nFolder.prototype.findOne = function(filter_, type){\n\tvar res = this.find(filter_, type);\n\treturn res.length ? res[0] : null;\n}\n\n/**\n * Returns the number of immediate children.\n * \n * @this {EThing.Folder}\n * @returns {number}\n */\nFolder.prototype.length = function(){\n\treturn this.children().length;\n}\n\n\n// extend the EThing.Resource class\n/**\n * Returns the parent directory of this resource, Returns undefined if this resource is the root directory.\n * \n * @memberof EThing.Resource\n * @this {EThing.Resource}\n * @returns {EThing.Resource|undefined}\n */\nEThing.Resource.prototype.parent = function(){\n\tif(!this.isRoot)\n\t\treturn findOneById('/'+this.dirname());\n}\n\n\n\nEThing.Folder = Folder;\n\n\n\nfunction clear(){\n\tresources = [];\n\tloaddfr = null;\n\troot = null;\n}\n\n\n/**\n * Load all available resources.\n * @memberof EThing.arbo\n * @param {function(EThing.Resource[])} [callback] function executed once the resources are loaded\n * @param {boolean} [force] force to reload the entire resources\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}.\n */\nfunction load(callback, force) {\n\tvar dfr;\n\t\n\tif(loaddfr && !force){\n\t\tif(loaddfr===true)\n\t\t\tdfr = new Deferred().resolve().promise();\n\t\telse\n\t\t\tdfr = loaddfr;\n\t}\n\telse {\n\t\tvar pdfr = new Deferred();\n\t\t\n\t\tclear();\n\t\t\n\t\t// load the resources\n\t\tEThing.request({\n\t\t\t'url': '/resources',\n\t\t\t'method': 'GET',\n\t\t\t'dataType': 'json'\n\t\t}).done(function(rs) {\n\t\t\t\n\t\t\tloaddfr = true;\n\t\n\t\t\t// reset everything\n\t\t\tresources = [];\n\t\t\t\n\t\t\t// add the root node\n\t\t\troot = new EThing.Folder({\n\t\t\t\t'name': ''\n\t\t\t});\n\t\t\t\n\t\t\tresources.push(root);\n\t\t\t\n\t\t\t// add the other resources\n\t\t\trs.forEach(function(resource) {\n\t\t\t\tif(!(resource = EThing.instanciate(resource))) return;\n\t\t\t\tadd(resource);\n\t\t\t});\n\t\t\t\n\t\t\tpdfr.resolve();\n\t\t});\n\t\t\n\t\tloaddfr = dfr = pdfr.promise();\n\t}\n\t\n\treturn dfr.done(function() {\n\t\tif (typeof callback == 'function')\n\t\t\tcallback(list());\n\t\t\n\t\t// trigger\n\t\tEThing.trigger('ething.arbo.loaded');\n\t});\n};\n\nfunction refresh(callback) {\n\treturn EThing.request({\n\t\t'url': '/resources',\n\t\t'method': 'GET',\n\t\t'dataType': 'json'\n\t}).then(function(rs) {\n\t\t\n\t\trs = rs.map(function(r){\n\t\t\treturn EThing.instanciate(r);\n\t\t}).filter(function(r){\n\t\t\treturn r;\n\t\t});\n\t\t\n\t\tupdate(rs, true);\n\t\t\n\t\treturn resources;\n\t}).done(callback);\n\t\n}\n\n\n\nfunction update(newResources, replaceAll, noTrigger){\n\t\n\tif(!Array.isArray(newResources)) newResources = [newResources];\n\t\n\tvar removed = [];\n\tvar added = [];\n\tvar updated = [];\n\t\n\tif(replaceAll){\n\t\t// check for removed resources\n\t\t// search for resources that have been deleted\n\t\tresources.forEach(function(r, index){\n\t\t\t\n\t\t\tif(r instanceof EThing.Folder) return;\n\t\t\t\n\t\t\tfor(var i in newResources){\n\t\t\t\tif(newResources[i].id() === r.id()){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tremoved.push(index);\n\t\t});\n\t\t\n\t\tremoved.map(function(i){\n\t\t\tvar r = resources[i];\n\t\t\tresources.splice(i, 1);\n\t\t\treturn r; \n\t\t});\n\t}\n\t\n\t// check for new resources or update ones\n\tnewResources.forEach(function(r, index){\n\t\t\n\t\tvar found = false;\n\t\tfor(var i in resources){\n\t\t\tif(resources[i].id() === r.id()){\n\t\t\t\tfound = i;\n\t\t\t\tbreak;;\n\t\t\t}\n\t\t}\n\t\tif(found===false){\n\t\t\t// new resource\n\t\t\tadded.push(r);\n\t\t\tadd(r);\n\t\t} else {\n\t\t\t// maybe updated ?\n\t\t\tvar o = resources[found];\n\t\t\tif(o._fromJson(r.json())){\n\t\t\t\tupdated.push(o);\n\t\t\t}\n\t\t\tnewResources[index] = o;\n\t\t}\n\t\t\n\t});\n\t\n\tif(replaceAll){\n\t\t// remove empty folder\n\t\tfor(var i=0; i<resources.length; i++){\n\t\t\tvar r = resources[i];\n\t\t\tif(r instanceof EThing.Folder){\n\t\t\t\tif(r.find(function(t){return !(t instanceof EThing.Folder);}).length==0){\n\t\t\t\t\tremoved.push(r);\n\t\t\t\t\tresources.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvar hasChanged = removed.length>0 || added.length>0 || updated.length>0;\n\t\n\tif(!noTrigger && hasChanged){\n\t\tEThing.trigger('ething.arbo.changed', [added, removed, updated]);\n\t}\n\t\n\treturn {\n\t\tresources : newResources,\n\t\tremoved : removed,\n\t\tadded : added,\n\t\tupdated: updated,\n\t\thasChanged: hasChanged\n\t};\n}\n\n\nfunction add(resource) {\n\t\n\tresources.push(resource);\n\t\n\t// check if the folder exist\n\tvar dirname = resource.dirname();\n\tvar f = false;\n\tfor(var i=0; i<resources.length; i++){\n\t\tif((resources[i] instanceof EThing.Folder) && resources[i].name() === dirname){\n\t\t\tf = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif(!f){\n\t\t// create the folder !\n\t\tadd(new EThing.Folder({\n\t\t\t'name': dirname\n\t\t}));\n\t}\n\t\n\treturn resource;\n}\n\n\n\nfunction remove(resource,noTraversingUp,noTrigger){\n\tif(Array.isArray(resource)){\n\t\tresource.forEach(function(r){\n\t\t\tremove(r, noTraversingUp);\n\t\t});\n\t\treturn;\n\t}\n\t\n\tif(typeof resource === 'string'){\n\t\tresource = findOneById(resource);\n\t\tif(!resource) return;\n\t}\n\t\n\tif(resource.isRoot === true) return; // do not remove the root directory !\n\t\n\tvar removed = [];\n\t\n\tif(resource instanceof EThing.Folder){\n\t\t// remove all the children first !\n\t\tresource.children().forEach(function(r){\n\t\t\tremove(r,true);\n\t\t});\n\t}\n\t\n\tfor (var i=0; i<resources.length; i++) {\n\t\tvar r = resources[i];\n\t\tif (r.id() == resource.id()) {\n\t\t\tremoved.push(r);\n\t\t\tresources.splice(i, 1);\n\t\t\tif(!noTraversingUp){\n\t\t\t\t// remove the associated folder ?\n\t\t\t\tvar folder = r.parent();\n\t\t\t\tif(folder && folder.children().length==0){\n\t\t\t\t\t// this directory has no more children, remove it !\n\t\t\t\t\tremove(folder);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tif(!noTrigger && removed.length){\n\t\tEThing.trigger('ething.arbo.changed', [[], removed, []]);\n\t}\n}\n\n\n\n/**\n * Find a resource by its unique id. For all the resources except the Folder, the id is a 7 character alphanumeric string.\n * Since there is no duplicate name for folders, their id is equal to their name.\n *\n * @memberof EThing.arbo\n * @param {string} id 7 character alphanumeric string for all resources except for Folders which is their name.\n * @return {EThing.Resource|undefined} return undefined if not found\n */\nfunction findOneById(w) {\n\tfor(var i=0; i<resources.length; i++)\n\t\tif(resources[i].id() === w)\n\t\t\treturn resources[i];\n};\n\n\n\n\n/**\n * Returns a list of resources that pass the test implemented by the provided function or regular expression (as a string or a RegExp object).\n * The find() method creates a new array with all the resources that pass the test implemented by the provided first argument.\n *\n * The test argument's type must be one of the following :\n *   - function : function to test each resource. Invoked with arguments (EThing.Resource). Return true to keep the resource, false otherwise.\n *   - string : only the resources that match the given relative name are returned (note: two resource can have the same name).\n *   - string[] : only the resources that match the given relative names are returned.\n *   - RegExp : only the resources satisfying this regular expression is returned.\n *   - undefined : returns all the resources\n * \n * @memberof EThing.arbo\n * @param {function(EThing.Resource,relativeName)|string|string[]|RegExp} [filter] only the resources that match the filter are returned.\n * @return {EThing.Resource[]}\n */\nfunction find(filter, type){\n\treturn resources.filter(function(r){\n\t\tif(!type || r.type() === type){\n\t\t\tvar name = r.name();\n\t\t\tif(typeof filter == 'function'){\n\t\t\t\treturn !!filter.call(r,r);\n\t\t\t}\n\t\t\telse if(typeof filter == 'string'){\n\t\t\t\treturn name === filter;\n\t\t\t}\n\t\t\telse if(Array.isArray(filter)){\n\t\t\t\treturn filter.indexOf(name) >= 0;\n\t\t\t}\n\t\t\telse if(filter instanceof RegExp){\n\t\t\t\treturn filter.test(name);\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn true;\n\t\t}\n\t\t\n\t});\n}\n\n/**\n * Same as {@link EThing.arbo.find} except that it will return only one result (the first resource that match the filter) or null if nothing was found.\n * See {@link EThing.arbo.find} for more details about the argument.\n *  \n * @memberof EThing.arbo\n * @param {function(EThing.Resource,relativeName)|string|string[]|RegExp} [filter] only the first resource that match the filter is returned.\n * @returns {EThing.Resource|null}\n */\nfunction findOne(filter, type){\n\tvar res = find(filter, type);\n\treturn res.length ? res[0] : null;\n}\n\n\n/**\n * return all the resources. Same as {@link EThing.arbo.find|EThing.arbo.find()}.\n * @memberof EThing.arbo\n * @return {EThing.Resource[]}\n */\nfunction list(){\n\treturn resources;\n}\n\n\n\n\n\n\n\n\nEThing.on('ething.resource.removed', function(evt, resourceId){\n\tvar resource = findOneById(resourceId);\n\tif(resource)\n\t\tremove(resource);\n});\n\n\n\n\nEThing.arbo = {\n\tload: load,\n\tlastRefreshTs: 0,\n\trefresh: function(){\n\t\tthis.lastRefreshTs = Date.now();\n\t\treturn refresh.apply(this, Array.prototype.slice.call(arguments));\n\t},\n\tremove: remove,\n\tupdate: update,\n\tfindOneById: findOneById,\n\tlist: list,\n\tfind: find,\n\tfindOne: findOne,\n\t\n\t/**\n\t * Check if the resources are loaded (ie. if the {@link EThing.arbo.load} function has been called and has returned).\n\t * @memberof EThing.arbo\n\t * @return {boolean}\n\t */\n\tisLoaded: function(){\n\t\treturn loaddfr === true || ( loaddfr && loaddfr.state() == 'resolved' );\n\t},\n\t\n\t/**\n\t * Returns the root directory. If the {@link EThing.arbo.load} function was not called before, this function will return null.\n\t * @memberof EThing.arbo\n\t * @return {EThing.Folder|null}\n\t */\n\troot: function(){\n\t\treturn root;\n\t}\n};\n\nmodule.exports = EThing.arbo;\n","var EThing = require(\"../core.js\");\nvar utils = require(\"../utils.js\");\nvar Device = require(\"../device.js\");\n\nDevice.MQTT = {};\n\nDevice.MQTT.getSubscription = function(dev, callback){\n\tvar context;\n\t\n\tif(dev instanceof Device){\n\t\tcontext = dev;\n\t\tdev = dev.id();\n\t}\n\telse if(!utils.isId(dev))\n\t\tthrow \"First argument must be a Device object or a Device id !\";\n\t\n\treturn EThing.request({\n\t\t'url': '/devices/' + dev + '/subscription',\n\t\t'dataType': 'json',\n\t\t'context': context,\n\t\t'converter': function(subs){\n\t\t\tif(context instanceof Device){\n\t\t\t\t// attach this specification to the device\n\t\t\t\tcontext.subscription = subs;\n\t\t\t}\n\t\t\treturn subs;\n\t\t}\n\t},callback);\n\t\n};\n\n\nmodule.exports = Device.MQTT;\n\n","var EThing = require(\"../core.js\");\nvar utils = require(\"../utils.js\");\nvar Device = require(\"../device.js\");\n\n\nDevice.Http = {};\n\n\nDevice.Http.getSpecification = function(dev, callback){\n\tvar context;\n\t\n\tif(dev instanceof Device){\n\t\tcontext = dev;\n\t\tdev = dev.id();\n\t}\n\telse if(!utils.isId(dev))\n\t\tthrow \"First argument must be a Device object or a Device id !\";\n\t\n\treturn EThing.request({\n\t\t'url': '/devices/' + dev + '/specification',\n\t\t'dataType': 'json',\n\t\t'context': context,\n\t\t'converter': function(spec){\n\t\t\tif(context instanceof Device){\n\t\t\t\t// attach this specification to the device\n\t\t\t\tcontext.swaggerSpecification = spec;\n\t\t\t}\n\t\t\treturn spec;\n\t\t}\n\t},callback);\n\t\n};\n\nmodule.exports = Device.Http;\n","\nvar EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\nvar Deferred = require(\"./deferred.js\");\n\n/**\n * Constructs a Rule instance from an object decribing a rule. Should not be called directly. Use instead {@link EThing.list}.\n * @protected\n * @class The Rule resource handle an application\n * @memberof EThing\n * @extends EThing.Resource\n * @param {object} json\n */\nvar Rule = function(json)\n{\n\tResource.call(this, json);\n}\nutils.inherits(Rule, Resource);\n\n// specific methods\n\n/**\n * Returns true if this rule is enabled.\n * @this {EThing.Rule}\n * @returns {boolean}\n */\nRule.prototype.enabled = function() {\n\treturn !!this._json.enabled;\n}\n\n/**\n * Returns the id of the script file.\n * @this {EThing.Rule}\n * @returns {string}\n */\nResource.prototype.script = function(){\n\treturn this._json.script;\n}\n\n/**\n * Returns an object describing the event.\n * @this {EThing.Rule}\n * @returns {object}\n */\nResource.prototype.event = function(){\n\treturn this._json.event;\n}\n\n/**\n * Returns the last exit code returned by the script of this rule.\n * @this {EThing.Rule}\n * @returns {number}\n */\nRule.prototype.scriptReturnCode = function() {\n\treturn this._json.script_return_code;\n}\n\n/**\n * Returns the number of times this rule has been executed.\n * @this {EThing.Rule}\n * @returns {number}\n */\nRule.prototype.scriptExecutionCount = function() {\n\treturn this._json.script_execution_count;\n}\n\n/**\n * Returns the last time this rule has been executed.\n * @this {EThing.Rule}\n * @returns {Date}\n */\nRule.prototype.scriptExecutionDate = function() {\n\treturn new Date(this._json.script_execution_date);\n}\n\n\n/**\n * Run this rule.\n * @this {EThing.Rule}\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Rule} The instance on which this method was called.\n */\nRule.prototype.execute = function(callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Rule.execute.apply(EThing, args);\n\t\t});\n}\n\n\n\n/**\n * Creates a new Rule from the following attributes :\n *   - name {string} __required__ the name of the rule\n *   - script {EThing.File} __required__ the JavaScript code to be executed\n *   - event {object} __required__ the event object describing when to execute this rule\n *       - event.type {string} __required__ the type name of the event (Timer, ResourceCreated, ...)\n *       - event.*  some options depending of the type of event\n *   - script_args {string} an optional string holding the arguments to pass to the script\n *\n * @method EThing.Rule.create\n * @param {object} attributes\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @fires EThing#ething.rule.created\n * @example\n * EThing.Rule.create({\n *   name: \"myRule\",\n *   script: <script_id>,\n *   event: {\n *     type: 'ResourceCreated' // this rule will be fired each time a resource is created !\n *   }\n * }).done(function(resource){\n *     console.log('the new rule is created');\n * })\n */\nRule.create = function(json,callback){\n    \n    if(json.script instanceof EThing.Resource)\n        json.script = json.script.id();\n    \n\treturn EThing.request({\n\t\t'url': '/rules',\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': json,\n\t\t'converter': EThing.resourceConverter\n\t},callback).done(function(r){\n\t\tEThing.trigger('ething.rule.created',[r]);\n\t});\n    \n\t\n};\n\n\n/*\nResource,callback\n*/\nRule.execute = function(a,b)\n{\n\tvar file_id = null, context;\n\tif(a instanceof Rule){\n\t\tcontext = a;\n\t\tfile_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\tfile_id = a;\n\telse {\n\t\tthrow \"First argument must be a Rule object or a rule id !\";\n\t\treturn;\n\t}\n\t\n\tvar callback = b;\n\t\n\treturn EThing.request({\n\t\t'url': '/rules/' + file_id + '/execute',\n\t\t'method': 'GET',\n\t\t'dataType': 'text',\n\t\t'context': context\n\t},callback);\n};\n\n\nEThing.Rule = Rule;\n\t\nmodule.exports = Rule;\n","\nvar EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\nvar Deferred = require(\"./deferred.js\");\n\n/**\n * Constructs an App instance from an object decribing an application. Should not be called directly. Use instead {@link EThing.list}.\n * @protected\n * @class The App resource handle an application\n * @memberof EThing\n * @extends EThing.Resource\n * @param {object} json\n */\nvar App = function(json)\n{\n\tResource.call(this, json);\n}\nutils.inherits(App, Resource);\n\n// specific methods\n\n/**\n * Returns the size of this application in bytes.\n * @this {EThing.App}\n * @returns {number}\n */\nApp.prototype.size = function() {\n\treturn this._json.size || 0;\n}\n\n/**\n * If this application has an icon, it returns his link, else it returns null.\n * \n * @this {EThing.App}\n * @param {boolean} [auth=false] wether or not attach any authentication element. Necessary if you are not using {@link EThing.request}.\n * @returns {string|null}\n * @example\n * // the simple way\n * var image = new Image();\n * image.src = imageFile.iconLink(true);\n * document.body.appendChild(image);\n *\n * // the hard way\n * EThing.request({\n *   url: imageFile.iconLink(),\n *   dataType: \"blob\"\n * }).done(function(blobData){\n *   // success\n *   var image = new Image();\n *   image.src = window.URL.createObjectURL( blobData );\n *   \n *   document.body.appendChild(image);\n * });\n */\nApp.prototype.iconLink = function(auth) {\n\treturn this._json.hasIcon ? EThing.toApiUrl('apps/'+this.id()+'/icon',auth) : null;\n}\n\n/**\n * Returns the link to access the content.\n * @this {EThing.App}\n * @param {boolean} [auth=false] wether or not attach any authentication element. Necessary if you are not using {@link EThing.request}.\n * @returns {string}\n * @example\n * // using EThing.request() :\n * EThing.request(app.getContentUrl()).done(function(content){\n *   // success\n *   console.log('content as text : '+content);\n * });\n */\nApp.prototype.getContentUrl = function(auth) {\n\treturn EThing.toApiUrl('apps/'+this.id(),auth);\n}\n\n/**\n * Last time the content of this resource was modified\n * @this {EThing.App}\n * @returns {Date}\n */\nApp.prototype.contentModifiedDate = function() {\n\treturn new Date(this._json.contentModifiedDate);\n}\n\n/**\n * Return the scope of this app.\n * @this {EThing.App}\n * @returns {string}\n */\nApp.prototype.scope = function() {\n  return (typeof this._json.scope == 'string') ? this._json.scope : '';\n}\n\n/**\n * Return the version of this app or null if this app is not versioned.\n * @this {EThing.App}\n * @returns {string}\n */\nApp.prototype.version = function() {\n  return this._json.version || null;\n}\n\n/**\n * Gets the code of this application in text/html.\n * @this {EThing.App}\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.App} The instance on which this method was called.\n */\nApp.prototype.read = function(callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn App.read.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Writes some HTML script in this application. Only available for {@link EThing.App#isEditable|editable app}\n * @this {EThing.App}\n * @param {string} data the full HTML script\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.App} The instance on which this method was called.\n */\nApp.prototype.write = function(data, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn App.write.apply(EThing, args);\n\t\t});\n}\n\n\n\n\n/**\n * Creates a new Application from the following attributes :\n *   - name {string} __required__ the name of the application\n *   - description {string} a string describing this application \n *   - data {object} key/value pairs to attach to this application\n *   - content {string} the full base64 encoded script\n *   - icon {string} the base64 encoded icon of this application\n *\n * @method EThing.App.create\n * @param {object} attributes\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @fires EThing#ething.app.created\n * @example\n * EThing.App.create({\n *   name: \"myApp\",\n *   content: \"<html><body>hello world !</body></html>\",\n *   icon: <icon_data>, // File, Blob, Buffer, ArrayBuffer or base64 string\n *   scope: \"resource:read settings:read\",\n * }).done(function(resource){\n *     console.log('the new app can be accessed through : ' + resource.url());\n * })\n */\nApp.create = function(json,callback){\n\t\n    var dfr = Deferred();\n    var json = utils.extend({}, json);\n    \n    utils.toBase64(json.content || '', function(content){\n        json.content = content;\n        \n        utils.toBase64(json.icon || '', function(icon){\n            json.icon = icon;\n            \n            EThing.request({\n\t\t\t\t'url': '/apps',\n\t\t\t\t'dataType': 'json',\n\t\t\t\t'method': 'POST',\n\t\t\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t\t\t'data': json,\n\t\t\t\t'converter': EThing.resourceConverter\n\t\t\t  }).done(function(){\n\t\t\t\tdfr.resolveWith(this, Array.prototype.slice.call(arguments));\n\t\t\t  }).fail(function(){\n\t\t\t\tdfr.rejectWith(this, Array.prototype.slice.call(arguments));\n\t\t\t  });\n              \n        });\n    });\n    \n    return dfr.done(callback).done(function(){\n        EThing.trigger('ething.app.created',[this]);\n    }).promise();\n};\n\n\n/*\nResource,callback\n*/\nApp.read = function(a,b)\n{\n\tvar file_id = null, context;\n\tif(a instanceof App){\n\t\tcontext = a;\n\t\tfile_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\tfile_id = a;\n\telse {\n\t\tthrow \"First argument must be an App object or an app id !\";\n\t\treturn;\n\t}\n\t\n\tvar callback = b;\n\t\n\treturn EThing.request({\n\t\t'url': '/apps/' + file_id,\n\t\t'method': 'GET',\n\t\t'dataType': 'text',\n\t\t'context': context\n\t},callback);\n};\n\n/*\nResource,data,callback\n*/\nApp.write = function(a,b,c)\n{\n\tvar file_id = null, context;\n\tif(a instanceof App){\n\t\tcontext = a;\n\t\tfile_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\tfile_id = a;\n\telse {\n\t\tthrow \"First argument must be a App object or an app id !\";\n\t\treturn;\n\t}\n\t\n\tif( typeof b != 'string') {\n\t\tthrow \"Second argument must be a string !\";\n\t\treturn;\n\t}\n\t\n\tvar callback = c;\n\t\n\treturn EThing.request({\n\t\t'url': '/apps/' + file_id,\n\t\t'dataType': 'json',\n\t\t'method': 'PUT',\n\t\t'contentType': (typeof b == 'string') ? 'text/plain' : 'application/octet-stream',\n\t\t'data': b,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n};\n\n/*\nResource,callback\nreturn data as blob\n*/\nApp.getIcon = function(a,b)\n{\n\tvar file_id = null, context;\n\tif(a instanceof App){\n\t\tcontext = a;\n\t\tfile_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\tfile_id = a;\n\telse {\n\t\tthrow \"First argument must be a App object or an app id !\";\n\t\treturn;\n\t}\n\t\n\tvar callback = b;\n\t\n\treturn EThing.request({\n\t\t'url': '/apps/' + file_id + '/icon',\n\t\t'method': 'GET',\n\t\t'dataType': utils.isNode ? 'buffer' : 'blob',\n\t\t'context': context\n\t},callback);\n};\n\nEThing.App = App;\n\t\nmodule.exports = App;\n","var EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\n\n\n\n/**\n * Constructs a Table instance from an object decribing a table. Should not be called directly. Use instead {@link EThing.list}.\n * @protected\n * @class The Table resource handle data in rows and columns\n * @memberof EThing\n * @extends EThing.Resource\n * @param {object} json\n */\nvar Table = function(json)\n{\n\tResource.call(this, json);\n}\nutils.inherits(Table, Resource);\n\n\n// specific methods\n/**\n * The number of rows in this table\n * @this {EThing.Table}\n * @returns {number}\n */\nTable.prototype.length = function(){\n\treturn this._json['length'];\n}\n/**\n * The maximum number of rows allowed in this table. Returns null if this feature is disable (number of rows is unlimited).\n * @this {EThing.Table}\n * @returns {number|null}\n */\nTable.prototype.maxLength = function(){\n\treturn this._json.maxLength;\n}\n/**\n * Returns the amount of seconds after which a __row__ is automatically removed, or null if this feature is not enable.\n * @this {EThing.Table}\n * @returns {number}\n */\nTable.prototype.expireAfter = function(){\n\treturn this._json.expireAfter;\n}\n/**\n * Returns the keys in this table. __The default keys (\"id\" and \"date\" are not listed)__.\n * @this {EThing.Table}\n * @returns {string[]}\n */\nTable.prototype.keys = function(){\n\tvar keys = [];\n\tfor(var k in this._json.keys)\n\t\tif(this._json.keys.hasOwnProperty(k))\n\t\t\tkeys.push(k);\n\treturn keys;\n}\n/**\n * Last time the content of this resource was modified\n * @this {EThing.Table}\n * @returns {Date}\n */\nTable.prototype.contentModifiedDate = function() {\n\treturn new Date(this._json.contentModifiedDate);\n}\n/**\n * Returns rows.\n * @this {EThing.Table}\n * @param {Object} [options] Customize the selection\n * @param {number} [options.start=0] Position of the first rows to return. If start is negative, it starts from the end.\n * @param {number} [options.length] Maximum number of rows to return.\n * @param {string} [options.sort] The key on which to do the sorting, by default the sort is made by date.\n * @param {string} [options.query] A query string to filter the results.\n * @param {string} [options.fields] Fields of the results to return. If omitted, all the fields are returned.\n * @param {string} [options.datefmt] the format of the date field (values: \"RFC3339\"(default), \"TIMESTAMP\", \"TIMESTAMP_MS\", \"ISO8601\", \"RSS\").\n * @param {function(data,XHR,options)} [callback] It is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * @example\n * // returns all the content of a table :\n * table.select().done(function(data){\n *   // success\n * });\n *\n * // returns the last 10 rows sorted by the \"foo\" column :\n * table.select({start: -10, sort: \"foo\"}).done(function(data){\n *   // success\n * });\n *\n */\nTable.prototype.select = function(options,callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Table.select.apply(EThing, args);\n\t\t});\n}\n/**\n * Performs statistics on a specific column.\n * @this {EThing.Table}\n * @param {string} key The column name on which the statistics should be performed.\n * @param {string} [query] A query string to filter the data.\n * @param {function(statistics,XHR,options)} [callback] It is executed once the request is complete whether in failure or success\n * @returns {Object} The instance on which this method was called.\n *\n */\nTable.prototype.computeStatistics = function(key,query,callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Table.computeStatistics.apply(EThing, args);\n\t\t});\n}\n/**\n * Removes one or multiple rows.\n * @this {EThing.Table}\n * @param {string|string[]} id The id of the row(s) to be removed\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * @example\n * // removes the last 10 rows :\n * table.select(-10).done(function(data){\n *   this.removeRow(data.map(function(row){\n *     return row.id;\n *   }));\n * });\n *\n */\nTable.prototype.removeRow = function(id,callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Table.removeRow.apply(EThing, args);\n\t\t});\n}\n/**\n * Set new data to a row.\n * @this {EThing.Table}\n * @param {object} data the data to be updated, it must contain the row id.\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * @example\n * table.replaceRow({\n * \t 'id': 'g45Tdk4',\n * \t 'value': 45\n * }).done(function(data){\n *   // updated !\n * });\n *\n */\nTable.prototype.replaceRow = function(data,callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Table.replaceRow.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Finds a single row matching the query and replaces it.\n * @this {EThing.Table}\n * @param {string} query A query string to filter the data.\n * @param {object} data the new data.\n * @param {boolean} [upsert] If true, the data will be inserted if no match is found. (default to false).\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * @example\n * table.findOneAndReplace(\"name=='foo'\", {\n * \t 'name': 'foo',\n * \t 'value': 'bar'\n * }).done(function(table){\n *   // updated or inserted if not found !\n * });\n *\n */\nTable.prototype.findOneAndReplace = function(query,data,upsert,callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn Table.findOneAndReplace.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Insert new data into the table. The data argument must be a key/value object.\n * @this {EThing.Table}\n * @param {object} data\n * @param {string} [invalid_field] The behaviour to adopt when an invalid field name appears. The value must be one of the following : \"rename\",\"stop\",\"skip\",\"none\".\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * @example\n * table.insert({\n *   'field1': \"foobar\",\n *   'field2': 3.14,\n *   'field3': true\n * }).done(function(){\n *   // success\n * });\n *\n */\nTable.prototype.insert = function(data, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\targs.unshift(this);\n\t\treturn Table.insert.apply(this,args);\n\t});\n}\n\n/**\n * Replace the content of this table by a new set of data.\n * @this {EThing.Table}\n * @param {object[]} data\n * @param {string} [invalid_field] The behaviour to adopt when an invalid field name appears. The value must be one of the following : \"rename\",\"stop\",\"skip\",\"none\".\n * @param {bool} [skip_error] Whether to skip data on error or not\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.Table} The instance on which this method was called.\n * // copy table content\n * var tableSrc, tableDst;\n * tableSrc.select().done(function(data){\n *   tableDst.import(data);\n * });\n *\n */\nTable.prototype.import = function(data, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\targs.unshift(this);\n\t\treturn Table.import.apply(this,args);\n\t});\n}\n\n/**\n * Returns the link to access the content.\n * @this {EThing.Table}\n * @param {boolean} [auth=false] wether or not attach any authentication element. Necessary if you are not using {@link EThing.request}.\n * @returns {string}\n * @example\n * // using EThing.request() :\n * EThing.request(table.getContentUrl()).done(function(rows){\n *   // success, rows is an array of object \n *   console.log('number of rows : '+rows.length);\n * });\n * \n * // or using jQuery :\n * $.getJSON(table.getContentUrl(true)).done(function(rows){\n *   // success\n * });\n */\nTable.prototype.getContentUrl = function(auth) {\n\treturn EThing.toApiUrl('tables/'+this.id(),auth);\n}\n\n\n\n\n/**\n * Creates a new Table from the following attributes :\n *   - name {string} __required__ the name of the table\n *   - description {string} a string describing this table \n *   - data {object} key/value pairs to attach to this table\n *   - expireAfter {number} amount of seconds after which a row is automatically removed, 0 means unlimited. Default to 0.\n *   - maxLength {number} the maximum number of rows allowed in this table. 0 means unlimited. Default to 5000.\n *\n * @method EThing.Table.create\n * @param {object} attributes\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @fires EThing#ething.table.created\n * @example\n * // get a resource by its id\n * EThing.Table.create({\n *   name: \"foobar\",\n *   expireAfter: 3600*24*7 // the data are automatically removed after 7 weeks\n * }).done(function(resource){\n *     console.log('table created : ' + resource.name());\n * })\n */\nTable.create = function(a,callback){\n\t\n\tif(typeof a == \"string\")\n\t\ta = {\n\t\t\t'name': a\n\t\t};\n\n\treturn EThing.request({\n\t\t'url': '/tables',\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': a,\n\t\t'converter': EThing.resourceConverter\n\t},callback).done(function(r){\n\t\tEThing.trigger('ething.table.created',[r]);\n\t});\n\t\n};\n\n\nTable.select = function(a,options,callback){\n\n\tvar table_id = null, context;\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif((typeof callback == 'undefined') && (typeof options == 'function')){\n\t\tcallback = options;\n\t\toptions = null;\n\t}\n\t\n\toptions = options || {};\n\t\n\tif(Array.isArray(options.fields)){\n\t\toptions.fields = options.fields.join(',');\n\t}\n\t\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '?' + utils.param({'start':options.start,'length':options.length,'sort':options.sort,'q':options.query,'fields':options.fields,'datefmt':options.datefmt}),\n\t\t'method': 'GET',\n\t\t'dataType': 'json',\n\t\t'context': context\n\t},callback);\n\t\n}\n\nTable.computeStatistics = function(a,key,query,callback){\n\n\tvar table_id = null, context;\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif((typeof callback == 'undefined') && (typeof query == 'function')){\n\t\tcallback = query;\n\t\tquery = null;\n\t}\n\t\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '/statistics?' + utils.param({'key':key,'q':query}),\n\t\t'method': 'GET',\n\t\t'dataType': 'json',\n\t\t'context': context\n\t},callback);\n\t\n}\n\n\n/*\nTable,id,callback\n*/\nTable.removeRow = function(a,b,c){\n\n\tvar table_id = null, context;\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tvar id = Array.isArray(b) ? b : [b];\n\tvar callback = c;\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '/remove',\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': id,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n\t\n}\n\n/*\nTable,data,callback\n*/\nTable.replaceRow = function(a,b,c){\n\n\tvar table_id = null, context;\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif(typeof b === 'object' && !utils.isId(b.id))\n\t\tthrow \"Second argument must be an object containing at least a document id\";\n\t\n\tvar docId = b.id\n\tvar callback = c;\n    \n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '/id/'+docId,\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': b,\n\t\t'context': context,\n\t\t'headers': {\n\t\t\t\"X-HTTP-Method-Override\": \"PATCH\"\n\t\t}\n\t},callback);\n\t\n}\n\n/*\nTable,query,data[,upsert][,callback]\n*/\nTable.findOneAndReplace = function(a,b,c,d,e){\n\n\tvar table_id = null, context, callback = e, upsert = false;\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif(typeof b !== 'string')\n\t\tthrow \"Second argument must be a query string\";\n\t\n\tif(typeof c !== 'object')\n\t\tthrow \"Third argument must be an object\";\n\t\n\tif(typeof e === 'undefined' && typeof d === 'function'){\n\t\tcallback = d;\n\t\tupsert = false;\n\t}\n\tif(typeof d === 'boolean') {\n\t\tupsert = d;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '/replace?' + utils.param({'q':b, 'upsert':upsert}),\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': c,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n\t\n}\n\n/*\nTable,kv,callback\nTable,column,data,callback\n\nkv = {\n\t...\n\tcolumnX: valueX,\n\t...\n}\n\nNote : if valueX is null, so no data will be appended and the columnX will be created if it does not exist\n\n*/\nTable.insert = function(a,postData,c,d){\n\t\n\tvar callback, table_id = null, context, invalid_field;\n\t\n\tif(a instanceof Table){\n\t\tcontext = a;\n\t\ttable_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\ttable_id = a;\n\telse {\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif( typeof c == 'string' ){\n\t\tinvalid_field = c;\n\t\tcallback = d;\n\t}\n\telse {\n\t\tcallback = c;\n\t}\n\t\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table_id + '?' + utils.param({'invalid_field':invalid_field}),\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': postData,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n\t\n}\n\n\nTable.import = function(table,data){\n\tvar context,invalid_field,skip_error,callback;\n\t\n\tif(table instanceof Table){\n\t\tcontext = table;\n\t\ttable = table.id();\n\t}\n\telse if(!utils.isId(table)){\n\t\tthrow \"First argument must be a Table object or a table id !\";\n\t\treturn;\n\t}\n\t\n\tif(!Array.isArray(data))\n\t\tthrow \"The data must be an array of objects\";\n\t\n\tfor(var i=2; i<arguments.length; i++){\n\t\tswitch(typeof arguments[i]){\n\t\t\tcase 'function':\n\t\t\t\tcallback = arguments[i];\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tskip_error = arguments[i];\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tinvalid_field = arguments[i];\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/tables/' + table + '?' + utils.param({'skip_error':skip_error,'invalid_field':invalid_field}),\n\t\t'dataType': 'json',\n\t\t'method': 'PUT',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': data,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n\t\n}\n\nEThing.Table = Table;\n\nmodule.exports = Table;\n\n","\nvar EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\nvar Resource = require(\"./resource.js\");\nvar Deferred = require(\"./deferred.js\");\n\n\n/**\n * Constructs a File instance from an object decribing a file. Should not be called directly. Use instead {@link EThing.list}.\n * @protected\n * @class The File resource handle regular file such as image or text\n * @memberof EThing\n * @extends EThing.Resource\n * @param {object} json\n */\nvar File = function(json)\n{\n\tResource.call(this, json);\n}\nutils.inherits(File, Resource);\n\n/**\n * Returns the size of this file in bytes.\n * @this {EThing.File}\n * @returns {number}\n */\nFile.prototype.size = function() {\n\treturn this._json.size;\n}\n/**\n * Returns the amount of seconds after the last update after which this file is removed automatically, or null if this feature is not enable (no time limit).\n * @this {EThing.File}\n * @returns {number|null}\n */\nFile.prototype.expireAfter = function(){\n\treturn this._json.expireAfter || null;\n}\n/**\n * Returns the MIME type of this file\n * @this {EThing.File}\n * @returns {string}\n */\nFile.prototype.mime = function(){\n\treturn this._json.mime;\n}\n\n/**\n * Last time the content of this resource was modified\n * @this {EThing.File}\n * @returns {Date}\n */\nFile.prototype.contentModifiedDate = function() {\n\treturn new Date(this._json.contentModifiedDate);\n}\n\n/**\n * If this file has a thumbnail (thumbnail is only available for file with MIME type __image/*__), it returns his link, else it returns null.\n * \n * @this {EThing.File}\n * @param {boolean} [auth=false] wether or not attach any authentication element. Necessary if you are not using {@link EThing.request}.\n * @returns {string|null}\n * @example\n * // the simple way\n * var image = new Image();\n * image.src = imageFile.thumbnailLink(true);\n * document.body.appendChild(image);\n *\n * // the hard way\n * EThing.request({\n *   url: imageFile.thumbnailLink(),\n *   dataType: \"blob\"\n * }).done(function(blobData){\n *   // success\n *   var image = new Image();\n *   image.src = window.URL.createObjectURL( blobData );\n *   \n *   document.body.appendChild(image);\n * });\n */\nFile.prototype.thumbnailLink = function(auth) {\n  return this._json.hasThumbnail ? EThing.toApiUrl('files/'+this.id()+'/thumbnail',auth) : null;\n}\n\n/**\n * Returns the link to access the content.\n * @this {EThing.File}\n * @param {boolean} [auth=false] wether or not attach any authentication element. Necessary if you are not using {@link EThing.request}.\n * @returns {string}\n * @example\n * // using EThing.request() :\n * EThing.request(file.getContentUrl()).done(function(content){\n *   // success\n *   console.log('content as text : '+content);\n * });\n *\n * // HTML <img> Tag :\n * var image = new Image();\n * image.src = imageFile.getContentUrl(true);\n * document.body.appendChild(image);\n */\nFile.prototype.getContentUrl = function(auth) {\n\treturn EThing.toApiUrl('files/'+this.id(),auth);\n}\n\n/**\n * Returns true if this file has text based content.\n * @this {EThing.File}\n * @returns {boolean}\n */\nFile.prototype.isText = function() {\n\treturn this._json.isText;\n}\n\n/**\n * Returns true if this file is a script.\n * @this {EThing.File}\n * @returns {boolean}\n */\nFile.prototype.isScript = function() {\n\treturn this._json.isText && this._json.mime === 'application/javascript';\n}\n\n// specific methods\n\n/**\n * Execute a script file.\n * @this {EThing.File}\n * @param {string} [arguments] a string containing the arguments\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.File} The instance on which this method was called.\n * @example\n * file.execute().done(function(result){\n *   // success\n *   console.log(result);\n * });\n *\n */\nFile.prototype.execute = function(args, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn File.execute.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Gets the content of this file as text or as binary data.\n * @this {EThing.File}\n * @param {boolean} [binary] if true, return the content as binary data (as Blob in a browser, or Buffer in NodeJs)\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.File} The instance on which this method was called.\n * @example\n * file.read().done(function(content){\n *   // success\n *   console.log('content as text : '+content);\n * });\n * \n * // browser :\n * file.read(true).done(function(contentAsBlob){\n *   // success\n * });\n *\n * // NodeJs :\n * var fs = require(\"fs\");\n * EThing.get('kDO5Fk4').done(function(resource){\n * \tresource.read(true).done(function(data){\n * \t\t// data : Buffer instance\n * \t\tfs.writeFile(resource.basename(), data, function(){\n * \t\t\tconsole.log('It\\'s saved!');\n * \t\t});\n * \t});\n * });\n *\n */\nFile.prototype.read = function(binary, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn File.read.apply(EThing, args);\n\t\t});\n}\n\n/**\n * Writes some content to this file.\n * @this {EThing.File}\n * @param {string|blob|arraybuffer} data\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {EThing.File} The instance on which this method was called.\n * @example\n * file.write(\"hello world !\").done(function(){\n *   // success\n * });\n *\n */\nFile.prototype.write = function(data, callback){\n\tvar args = [].slice.call(arguments);\n\treturn this.deferred(function(){\n\t\t\targs.unshift(this);\n\t\t\treturn File.write.apply(EThing, args);\n\t\t});\n}\n\n\n\n/**\n * Creates a new File from the following attributes :\n *   - name {string} __required__ the name of the file\n *   - description {string} a string describing this file \n *   - data {object} key/value pairs to attach to this file\n *   - expireAfter {number} amount of seconds after the last update after which this file is removed automatically, 0 means unlimited. Default to 0.\n *\n * @method EThing.File.create\n * @param {object} attributes\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @fires EThing#ething.file.created\n * @example\n * EThing.File.create({\n *   name: \"foobar.txt\",\n *   description: \"this is my file\"\n * }).done(function(resource){\n *     console.log('file created : ' + resource.name());\n * })\n */\nFile.create = function(a,callback){\n\t\n\tif(typeof a == \"string\")\n\t\ta = {\n\t\t\t'name': a\n\t\t};\n\t\n    var dfr = Deferred();\n    var json = utils.extend({}, a);\n    \n    utils.toBase64(json.content || '', function(content){\n        json.content = content;\n        \n        EThing.request({\n            'url': '/files',\n            'dataType': 'json',\n            'method': 'POST',\n            'contentType': \"application/json; charset=utf-8\",\n            'data': json,\n            'converter': EThing.resourceConverter\n        },callback).done(function(){\n            dfr.resolveWith(this, Array.prototype.slice.call(arguments));\n        }).fail(function(){\n            dfr.rejectWith(this, Array.prototype.slice.call(arguments));\n        });\n        \n    });\n    \n    return dfr.done(callback).done(function(){\n        EThing.trigger('ething.file.created',[this]);\n    }).promise();\n};\n\n/*\nResource,boolean,callback{function({string|buffer})}\n*/\nFile.read = function(file, binary, callback)\n{\n\tvar context;\n\tif(file instanceof File){\n\t\tcontext = file;\n\t\tfile = file.id();\n\t}\n\telse if(!utils.isId(file)){\n\t\tthrow \"First argument must be a File object or a file id !\";\n\t}\n\t\n\tif(typeof callback == 'undefined' && typeof binary == 'function'){\n\t\tcallback = binary;\n\t\tbinary = false;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/files/' + file,\n\t\t'method': 'GET',\n\t\t'dataType': binary ? (utils.isNode ? 'buffer' : 'blob') : 'text',\n\t\t'context': context\n\t},callback);\n};\n\n/*\nResource,args,callback{function({object})}\n*/\nFile.execute = function(file, args, callback)\n{\n\tvar context;\n\tif(file instanceof File){\n\t\tcontext = file;\n\t\tfile = file.id();\n\t}\n\telse if(!utils.isId(file)){\n\t\tthrow \"First argument must be a File object or a file id !\";\n\t}\n\t\n\tif(typeof callback === 'undefined' && typeof args === 'function'){\n\t\tcallback = args;\n\t\targs = null;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/files/' + file + '/execute?' + utils.param({'args':args}),\n\t\t'method': 'GET',\n\t\t'dataType': 'json',\n\t\t'context': context\n\t},callback);\n};\n\n/*\nResource,data{string},callback{function({EThing.File})}\n*/\nFile.write = function(a,b,c)\n{\n\tvar file_id = null, context;\n\tif(a instanceof File){\n\t\tcontext = a;\n\t\tfile_id = a.id();\n\t}\n\telse if(utils.isId(a))\n\t\tfile_id = a;\n\telse {\n\t\tthrow \"First argument must be a File object or a file id !\";\n\t\treturn;\n\t}\n\t\n\tvar callback = c;\n\t\n\treturn EThing.request({\n\t\t'url': '/files/' + file_id,\n\t\t'dataType': 'json',\n\t\t'method': 'PUT',\n\t\t'contentType': (typeof b == 'string') ? 'text/plain' : 'application/octet-stream',\n\t\t'data': b,\n\t\t'context': context,\n\t\t'converter': EThing.resourceConverter\n\t},callback);\n};\n\nEThing.File = File;\n\nmodule.exports = File;\n","\nvar EThing = require(\"./core.js\");\n\n\n/**\n * Send a notification.\n * @memberof EThing\n * @param {string} [subject] The subject of the notification\n * @param {string} message The message of the notification\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n * @example\n * EThing.notify(\"hello world\")\n *   .done(function(){\n *     alert(\"A notification has been sent\");\n *   })\n */\nvar notify = function(subject,message, callback){\n\tvar query = {};\n\t\n\tif(arguments.length == 3){\n\t\tquery['body'] = message;\n\t\tquery['subject'] = subject;\n\t}\n\telse if(arguments.length == 2){\n\t\tif(typeof message == 'string'){\n\t\t\tquery['subject'] = subject;\n\t\t\tquery['body'] = message;\n\t\t}\n\t\telse{\n\t\t\tquery['body'] = subject;\n\t\t\tcallback = message;\n\t\t}\n\t}\n\telse if(arguments.length == 1){\n\t\tquery['body'] = subject;\n\t}\n\telse {\n\t\tthrow \"Bad arguments!\";\n\t\treturn;\n\t}\n\t\n\treturn EThing.request({\n\t\t'url': '/notification',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': query\n\t},callback);\n}\n\n\nEThing.notify = notify;\n\nmodule.exports = notify;\n","\t\nvar EThing = require(\"./core.js\");\nvar utils = require(\"./utils.js\");\n\n\n\n/*\n* Settings\n*/\n\nvar settings = {};\n\n/**\n * Retrieve the settings.\n * @memberof EThing.settings\n * @this {EThing.settings}\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n */\n\nsettings.get = function(callback){\n\treturn EThing.request({\n\t\t'url': '/settings',\n\t\t'dataType': 'json',\n\t\t'method': 'GET'\n\t},callback);\n};\n\n/**\n * Update the settings.\n * @memberof EThing.settings\n * @this {EThing.settings}\n * @param {object} [data] updated settings object\n * @param {function(data,XHR,options)} [callback] it is executed once the request is complete whether in failure or success\n * @returns {Deferred} a {@link http://api.jquery.com/category/deferred-object/|jQuery like Promise object}. {@link EThing.request|More ...} \n */\nsettings.set = function(data, callback){\n\t\n\tif(!utils.isPlainObject(data))\n\t\tthrow \"First argument must be an object !\";\n\t\n\t\n\treturn EThing.request({\n\t\t'url': '/settings',\n\t\t'dataType': 'json',\n\t\t'method': 'POST',\n\t\t'contentType': \"application/json; charset=utf-8\",\n\t\t'data': data,\n\t\t'headers': {\n\t\t\t\"X-HTTP-Method-Override\": \"PATCH\"\n\t\t}\n\t},callback);\n};\n\nEThing.settings = settings;\n\nmodule.exports = settings;\n\n\n","\nvar utils = require('./utils');\n\nvar Error_ = function(json){\n\tthis.constructor.prototype.__proto__ = Error.prototype\n\tError.captureStackTrace(this, this.constructor)\n\tthis.name = 'EThing.Error';\n\tif(typeof json == \"string\")\n\t\tjson = {\n\t\t\tmessage: json\n\t\t};\n\tif(json instanceof Error)\n\t\tjson = {\n\t\t\tmessage: json.message\n\t\t};\n\tutils.extend(this, {\n\t\tmessage: 'unknown error'\n\t}, json);\n}\n\n\nmodule.exports = Error_;\n\t\n","// browser specific code\n\nmodule.exports = {\n\t\n\t\"isNode\": false,\n\t\n\t\"btoa\": window.btoa,\n\t\n\t\"atob\" : window.atob,\n\t\n\t\"XMLHttpRequest\": window.XMLHttpRequest,\n\t\n\t'Blob': window.Blob,\n\t\n\t'Buffer': function(){},\n\t\n\t'FileReader': window.FileReader || null,\n\t\n\t'FileReaderSync': window.FileReaderSync || null\n\n};","/**\n * EThing - javascript API of the EThing project\n * @version v0.1.0\n */\n\n\nvar EThing = require(\"./core.js\");\n\nrequire(\"./resource.js\");\nrequire(\"./settings.js\");\nrequire(\"./notify.js\");\nrequire(\"./file.js\");\nrequire(\"./table.js\");\nrequire(\"./app.js\");\nrequire(\"./rule.js\");\nrequire(\"./device.js\");\nrequire(\"./devices/http.js\");\nrequire(\"./devices/mqtt.js\");\nrequire(\"./arbo.js\");\n\nmodule.exports = EThing;"],"sourceRoot":""}